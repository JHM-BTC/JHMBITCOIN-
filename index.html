// ====== PULAU D (Pulau D) ======
let pulauDInited=false;
function initPulauDOnce(){
  if(pulauDInited) return; pulauDInited=true;
  const hadiahDisplay = [
    { nominal:"Rp 7.000.000", logo:"üèÜ" },
    { nominal:"Rp 2.000.000", logo:"ü•á" },
    { nominal:"Rp 500.000",  logo:"üí∏" },
    { nominal:"Rp 100.000",   logo:"üí≥" },
    { nominal:"Rp 50.000",    logo:"ü§ë" },
    { nominal:"Rp 20.000",    logo:"ü™ô" },
    { nominal:"Rp 10.000",    logo:"üíµ" },
    { nominal:"Rp 5.000",     logo:"ü™ô" },
    { nominal:"Rp 2.000",     logo:"üí∞" },
  ];
  const prizePool = [2000,5000,10000,20000,50000,100000,500000,2000000,7000000];

  const d_btnSpin = document.getElementById('d_btnSpin');
  const d_prizeResult = document.getElementById('d_prizeResult');
  const d_modalPrize = document.getElementById('d_modalPrize');
  const d_tableBody = document.getElementById('d_tableBody');
  const d_resultText = document.getElementById('d_resultText');
  const d_btnCloseModal = document.getElementById('d_btnCloseModal');
  const d_btnBackToMap = document.getElementById('d_btnBackToMap');

  function formatRupiah(n){ return 'Rp '+n.toLocaleString('id-ID'); }

  d_btnSpin.onclick = function(){
    d_btnSpin.disabled = true;
    d_prizeResult.textContent = 'Mengacak hadiah...';
    setTimeout(function(){
      const prize = prizePool[Math.floor(Math.random()*prizePool.length)];
      openModalWithPrize(prize);
      d_btnSpin.disabled = false;
    }, 1200);
  };

  function openModalWithPrize(prize){
    d_tableBody.innerHTML='';
    hadiahDisplay.forEach(function(h,i){
      const tr=document.createElement('tr');
      const nominalNumber=Number(h.nominal.replace(/\D/g,''));
      tr.innerHTML='<td class="py-2 px-4">'+(i+1)+'</td><td class="py-2 px-4">'+h.nominal+'</td>';
      if(nominalNumber===prize) tr.classList.add('highlight');
      d_tableBody.appendChild(tr);
    });
    var userLabel = (session && session.userId) ? session.userId : '-';
    d_resultText.textContent = 'Selamat '+userLabel+'! Kamu mendapatkan '+formatRupiah(prize);
    d_modalPrize.classList.remove('hidden'); d_modalPrize.classList.add('flex'); document.body.style.overflow='hidden';
  }
  function closeModal(){ d_modalPrize.classList.add('hidden'); d_modalPrize.classList.remove('flex'); document.body.style.overflow=''; }
  d_btnCloseModal.onclick = closeModal;
  d_btnBackToMap.onclick = function(){ showScreen('game'); };
}
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Treasure Map ‚Äì Single File (Pulau A, B & C)</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800;900&family=Roboto:wght@400;500;700&display=swap');

html, body { height:100%; width:100%; overflow-y:auto !important; overscroll-behavior-y:contain; }
body{ font-family:'Inter',sans-serif; background:#14335f; min-height:100vh; overflow-y:auto !important; }

/* ================= HERO & GAME BACKGROUNDS ================= */
.bg-hero{ background:url('https://blogger.googleusercontent.com/img/a/AVvXsEhs_ZO5OnA0Q4Ex0Epuu_-sdtSNXQCB6BGJt3oN6L9JHuwJTX_qvQSrKy0eepPl_v7KnFbxmnmXqjQu79ElLlo47XLiJ91w0hrUmaHLABnc0hM0VpYftUkwitSdzy94xovlQa3OzRVKcNzGsB5FzaleKCzkiqxeZz8heWizjq2VcHeygZAkGhJtAkdJRHA') center/cover no-repeat; position:fixed; inset:0; width:100vw; height:100vh; z-index:0; overflow:hidden; }
.shine-effect{ position:absolute; inset:0; pointer-events:none; z-index:1; background:linear-gradient(120deg,rgba(255,255,255,0) 0%,rgba(255,255,255,0.18) 40%,rgba(255,255,255,0.38) 50%,rgba(255,255,255,0.18) 60%,rgba(255,255,255,0) 100%); opacity:.7; animation:shineMove 3.5s linear infinite; filter:blur(2px); }
@keyframes shineMove{ 0%{transform:translateX(-60vw) skewX(-18deg);} 100%{transform:translateX(120vw) skewX(-18deg);} }
.bg-game{ background:url('https://blogger.googleusercontent.com/img/a/AVvXsEgrcnQcPPcfE9A-hKDw7ESeN_N3Elivbjm1Qd21Iny4lUjt3e2enRw5Re482KPvPZQq4w9tLw9-BthklRaLGySVkZZwUO5qedf81xDawq4mR70BN-Q6WYNUvmF13sjJnkA5ze82lwXtlVt2L3q94VF2DBpW_5O3J_b3aBFQJB2wYvGQ9CHKtGOx6m9lZ5o') center/cover no-repeat; position:fixed; inset:0; width:100vw; height:100vh; z-index:0; }
.shine-effect-gold{ position:absolute; inset:0; pointer-events:none; z-index:1; background:linear-gradient(100deg,rgba(255,255,255,0) 0%,rgba(255,215,0,0.12) 30%,rgba(255,255,255,0.22) 38%,rgba(255,215,0,0.38) 50%,rgba(255,255,255,0.22) 62%,rgba(255,215,0,0.12) 70%,rgba(255,255,255,0) 100%); opacity:.85; animation:shineGoldMove 4.5s cubic-bezier(.4,1.6,.6,1) infinite; filter:blur(7px) brightness(1.3) saturate(1.4); mix-blend-mode:lighten; }
@keyframes shineGoldMove{ 0%{transform:translateX(-80vw) skewX(-22deg) scaleY(1.1);} 40%{transform:translateX(10vw) skewX(-18deg) scaleY(1.13);} 60%{transform:translateX(30vw) skewX(-16deg) scaleY(1.18);} 100%{transform:translateX(120vw) skewX(-22deg) scaleY(1.1);} }

/* ================= HERO CONTENT ================= */
.section-content{ position:relative; z-index:2; width:100%; }
.hero-map-frame{ display:flex; justify-content:center; align-items:center; margin:5vw auto 0; width:100%; position:relative; z-index:10; }
.neon-glow-border{ border-radius:2.2rem; box-shadow:0 0 0 22px #1ff1ff88, 0 0 66px 14px #1afcffcc, 0 0 260px 70px #0de7ff66, 0 0 360px 110px #29fffccc; border:6px solid #5efcf1; background:rgba(20,40,60,.45); padding:1vw; transition:box-shadow .3s; }
.neon-glow-border:hover{ box-shadow:0 0 0 30px #29fffebb, 0 0 250px 100px #07d8ffcc, 0 0 800px 160px #43fffccc; }
.hero-map-img{ width:820px; max-width:98vw; height:auto; display:block; border-radius:1.8rem; box-shadow:0 8px 48px 12px #02162daa; background:#18345d; }
@media (max-width:900px){ .hero-map-img{width:95vw;} .neon-glow-border{padding:2vw;} }
@media (max-width:650px){ .hero-map-img{width:99vw;} .neon-glow-border{padding:1.5vw;} .hero-map-frame{margin-top:7vw;} }
.glow-hero{ background:linear-gradient(90deg,#fffbe7 0%,#ffe259 25%,#ffd700 50%,#fff700 75%,#fffbe7 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; color:transparent; text-shadow:0 0 36px #fffbe7, 0 0 60px #ffd700, 0 0 80px #fff700, 0 2px 0 #fffbe7, 0 0 24px #ffd700; font-size:2.3rem; font-weight:900; letter-spacing:2px; margin-top:2.5rem; margin-bottom:1.5rem; }
@media (max-width:700px){ .glow-hero{ font-size:1.25rem; margin-top:1.2rem; } }
.hero-btn{ margin-top:28px; font-size:1.08rem; padding:14px 64px; border-radius:9999px; font-weight:700; background:linear-gradient(90deg,#fffbe7 0%,#ffe259 25%,#ffd700 50%,#fff700 75%,#fffbe7 100%); color:#222; box-shadow:0 0 0 8px #ffd700cc, 0 0 32px 8px #fffbe7cc, 0 0 120px 40px #ffd70088; border:3px solid #ffd700; text-shadow:0 0 18px #fffbe7, 0 2px 0 #ffd700; letter-spacing:2px; transition:transform .15s, box-shadow .15s; }
.hero-btn:hover{ transform:scale(1.06); box-shadow:0 0 0 16px #ffd700cc,0 0 64px 16px #fffbe7cc,0 0 240px 80px #ffd70088; color:#111; }

/* ================= GAME: KARTU ================= */
#island-container{ max-width:1400px; margin:0 auto; display:flex; flex-direction:row; justify-content:center; align-items:flex-start; gap:4rem; perspective:1800px; min-height:420px; flex-wrap:nowrap; }
.island-card-wrapper{ display:flex; flex-direction:column; align-items:center; gap:1.5rem; flex-shrink:0; margin:0 !important; }
.island-card{ width:340px; height:520px; background:linear-gradient(135deg,#13243a 80%,#21e3ff 100%); border-radius:2.6rem; box-shadow:0 0 0 8px rgba(255,215,0,.45),0 0 32px 8px rgba(255,215,0,.35),0 0 120px 40px rgba(255,215,0,.18),0 0 220px 60px rgba(255,215,0,.10); border:3px solid #FFD700; transition:transform .6s cubic-bezier(.4,2,.2,1), box-shadow .2s; cursor:pointer; position:relative; overflow:hidden; transform-style:preserve-3d; min-width:120px; min-height:160px; max-width:98vw; }
.island-card.flipped{ transform:rotateY(180deg) scale(1.08); box-shadow:0 0 0 12px rgba(144,238,144,.5),0 0 80px 30px rgba(144,238,144,.25),0 0 200px 60px rgba(144,238,144,.12); border:4px solid #90EE90; }
.island-card.shuffling-anim{ animation:cardShuffle .05s linear infinite; }
@keyframes cardShuffle{ 0%{transform:translateX(0) rotateY(0) scale(1);} 25%{transform:translateX(-150px) rotateY(180deg) scale(1.1);} 50%{transform:translateX(0) rotateY(360deg) scale(1);} 75%{transform:translateX(150px) rotateY(540deg) scale(1.1);} 100%{transform:translateX(0) rotateY(720deg) scale(1);} }
.island-card .island-front,.island-card .island-back{ position:absolute; inset:0; display:flex; flex-direction:column; align-items:center; justify-content:center; border-radius:2.5rem; backface-visibility:hidden; transition:transform .6s; }
.island-card .island-front{ transform:rotateY(0); }
.island-card .island-back{ background:#111b2b; transform:rotateY(180deg); }
.island-card.flipped .island-front{ transform:rotateY(-180deg); }
.island-card.flipped .island-back{ transform:rotateY(0); }
.island-card .island-img{ width:85%; height:85%; object-fit:contain; border-radius:1.5rem; border:none; box-shadow:0 8px 48px 0 #3b82f6cc; background:#18345d; }
.card-front-logo{ width:85%; height:85%; object-fit:contain; padding:1.1rem; }
#spinButton{ width:99vw; max-width:390px; font-size:1.24rem; padding:1.1rem 0; border-radius:9999px; font-weight:900; margin-top:2.2rem; margin-bottom:1.2rem; box-shadow:0 18px 88px 0 #fbbf24cc, 0 0 90px #fff700; letter-spacing:2px; background:linear-gradient(90deg,#ffe259 0%,#ffa751 100%); text-shadow:0 0 18px #fff, 0 2px 0 #000, 0 0 32px #ffd700; border:5px solid #fff700; transition:transform .15s, box-shadow .15s; }
#spinButton:hover:not(:disabled){ transform:scale(1.04); box-shadow:0 16px 80px 0 #ffd700cc, 0 0 80px #fff700; }
#spinButton:disabled{ cursor:not-allowed; opacity:.6; }
.neon-title{ font-size:4rem; font-weight:900; letter-spacing:2px; text-transform:uppercase; background:linear-gradient(90deg,#fffbe7 0%,#ffe259 25%,#ffd700 50%,#fff700 75%,#fffbe7 100%); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; color:transparent; text-shadow:0 0 36px #fffbe7, 0 0 60px #ffd700, 0 0 80px #fff700, 0 2px 0 #fffbe7, 0 0 24px #ffd700; margin-bottom:2.5rem; }
@media (max-width:900px){ .neon-title{font-size:2.7rem;} }
@media (max-width:650px){ .neon-title{font-size:1.6rem;} }
@media (max-width:1200px){ #island-container{gap:2.5rem;} .island-card{width:260px; height:380px;} }
@media (max-width:900px){ #island-container{gap:1.7rem;} .island-card{width:200px; height:300px;} }
@media (max-width:800px){ #island-container{gap:1.1rem;} .island-card{width:160px; height:210px;} }
@media (max-width:650px){ #island-container{ flex-direction:column; align-items:center; gap:1.2rem; flex-wrap:wrap; } .island-card-wrapper{ width:97vw; min-width:0; max-width:99vw; } .island-card{ width:98vw; height:170px; min-width:0; max-width:99vw; margin:0 auto; } .island-card .island-img,.card-front-logo{ width:62% !important; height:62% !important; padding:.22rem; } .neon-title{font-size:1.3rem;} #spinButton{font-size:1.1rem; padding:.9rem 0;} }
@media (max-width:430px){ .hero-btn{font-size:.62rem; padding:7px 6px;} .hero-map-frame{margin-top:7vw;} .neon-glow-border{padding:.2vw;} }
#game-section{ margin-top:3.5rem; }
@media (max-width:700px){ #game-section{ margin-top:2rem; } }

/* ================= MYSTERY (Scoped) ================= */
.mystery-root{ position:relative; min-height:calc(100vh - 66px - 64px); padding-bottom:24px; background:#121212; background-image:conic-gradient(from 0deg at 50% 50%, #ff00ff 0%, #ff00ff 10%, #ff9900 20%, #ffff00 30%, #00ff00 40%, #00ffff 50%, #0000ff 60%, #9900ff 70%, #ff00ff 80%, #ff00ff 100%); background-size:200% 200%; animation:rainbow-bg-shift 20s linear infinite; overflow-x:hidden; }
@keyframes rainbow-bg-shift{ 0%{background-position:0% 0%} 50%{background-position:100% 100%} 100%{background-position:0% 0%} }
.mystery .box-glow{ --angle:0deg; background:conic-gradient(from var(--angle) at 50% 50%, #ff00ff,#ff9900,#ffff00,#00ff00,#00ffff,#0000ff,#9900ff,#ff00ff); animation:rotate-gradient 3s linear infinite; position:relative; border-radius:1rem; box-shadow:0 0 24px rgba(255,0,255,.4),0 6px 22px rgba(255,255,255,.2); transition:box-shadow .2s, transform .12s; will-change:transform; }
.mystery .box-glow::before{ content:""; position:absolute; inset:0; border-radius:1rem; background:rgba(18,18,18,.7); border:2px solid #1a1a1a; z-index:1; }
.mystery .box-glow > span{ position:relative; z-index:2 }
.mystery .box-glow:hover{ transform:scale(1.06) rotate(-2deg); box-shadow:0 0 44px 12px rgba(255,0,255,.8),0 0 20px rgba(255,153,0,.8),0 0 0 2px #fff inset; }
@keyframes rotate-gradient{ to{ --angle:360deg } }
.mystery .rainbow-neon{ text-shadow:0 0 8px #fff,0 0 12px #ff00ff,0 0 20px #0000ff,0 0 30px #00ffff,0 0 40px #00ff00; }
.mystery .fade-in{ animation:fadein .35s ease }
@keyframes fadein{ from{opacity:0; transform:translateY(14px)} to{opacity:1; transform:translateY(0)} }
.mystery .modal-bg{ background:rgba(0,0,0,.7); backdrop-filter:blur(3px) }
.mystery .table th{ background:#4b0082; color:#fff }
.mystery .table td,.mystery .table th{ border-bottom:1px solid rgba(255,255,255,.1) }
.mystery .highlight{ background-image:linear-gradient(90deg,#ff00ff,#00ffff); color:#fff; font-weight:700 }
.mystery .picked{ outline:4px solid #22d3ee; box-shadow:0 0 30px #22d3ee77 inset }
.mystery .disabled{ pointer-events:none; opacity:.6 }
.mystery .twirl{ transform:rotateY(180deg) scale(.96) }
.mystery .topbar{ display:none !important; }

/* --- Header fix global --- */
.header-full{left:0;right:0;top:0;width:100% !important;}

/* ==================== PULAU B (GO GAPLE) ‚Äî SCOPED ==================== */
#screen-gaple{ --bg:#100525; --panel:#2a1a5e; --panel-2:#1c1044; --ink:#ffffff; --muted:#c0c8ff; --a:#ffd700; --b:#00c6ff; --c:#00ff7f; --success:#28a745; --neon:#39ff14; --neon2:#00ff88; --gold:#ffd700; --gold2:#fff7cc; --gold3:#ffb700; }
#screen-gaple *{ box-sizing:border-box }
#screen-gaple{ position:relative; min-height:100vh; color:var(--ink); font-family:Roboto, system-ui, -apple-system, Segoe UI, Inter, Arial, sans-serif; letter-spacing:.2px; }
#screen-gaple .site-header{ position:fixed; inset:0 0 auto 0; height:48px; display:flex; align-items:center; justify-content:space-between; padding:0 14px 0 12px; z-index:50; background:linear-gradient(90deg, #4a3a8a 0%, #6a4ecf 45%, #8a5fff 100%); box-shadow:0 2px 10px rgba(0,0,0,.45); border-bottom:1px solid rgba(255,255,255,.12) }
#screen-gaple .site-header .brand{ font-family:Orbitron, sans-serif; font-weight:900; letter-spacing:1px; font-size:14px; background:linear-gradient(90deg, #fff2ac, #ffd700); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 0 6px rgba(255,215,0,.45); }
#screen-gaple .home-btn{ --pad:8px 14px; position:relative; display:inline-flex; align-items:center; gap:8px; padding:var(--pad); border-radius:12px; border:1px solid rgba(255,255,255,.28); background:linear-gradient(180deg,#ffea70,#ffd700); color:#3d2500; font-weight:800; font-family:Orbitron; letter-spacing:.5px; text-decoration:none; box-shadow:0 6px 16px rgba(0,0,0,.4), inset 0 1px 1px rgba(255,255,255,.45), inset 0 0 8px rgba(255,248,220,.28) }
#screen-gaple .home-btn:hover{ filter:brightness(1.08) }
#screen-gaple .site-footer{ position:fixed; left:0; right:0; bottom:0; height:32px; z-index:40; display:flex; align-items:center; justify-content:center; padding:0 12px; background:linear-gradient(90deg,#1c1044 0%, #2a1a5e 50%, #3c2a8a 100%); border-top:1px solid rgba(255,255,255,.1); color:#e0e6ff; font-size:12px }
#screen-gaple .site-footer p{ margin:0; opacity:.9; letter-spacing:.2px }
#screen-gaple .b-wrap{ padding-top:58px; padding-bottom:36px; }
#screen-gaple .main-container{ max-width:1200px; margin:8px auto 32px; padding:24px; position:relative; border-radius:18px; background:linear-gradient(180deg, rgba(42,26,94,.9), rgba(28,16,68,.92)); box-shadow:0 8px 30px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.1); isolation:isolate; backdrop-filter: blur(4px); contain: content; content-visibility:auto; }
#screen-gaple .main-container::before{ content:""; position:absolute; inset:-2px; z-index:-1; border-radius:20px; background:conic-gradient(from 0deg at 10% 10%, var(--b), var(--a), var(--c), var(--b)); filter:blur(10px) saturate(150%); opacity:.8; mask:linear-gradient(#000 0 0) exclude, linear-gradient(#000 0 0) content-box; padding:2px }
#screen-gaple .main-container::after{ content:""; position:absolute; inset:0; border-radius:18px; pointer-events:none; padding:2px; background: radial-gradient(220px 160px at 92% 8%, rgba(255,255,255,.9), rgba(255,255,255,0) 60%), linear-gradient(135deg, var(--gold2) 0%, var(--gold) 35%, var(--gold3) 70%, #a86d00 100%); -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite: xor; mask-composite: exclude; filter: drop-shadow(0 0 18px rgba(255,215,0,.95)) drop-shadow(0 0 36px rgba(255,215,0,.65)) drop-shadow(0 0 64px rgba(255,200,0,.42)); opacity:.98; animation: goldBreath 2.6s ease-in-out infinite; }
@keyframes goldBreath{ 0%,100%{ opacity:.92 } 50%{ opacity:1 } }
#screen-gaple .title{ margin:6px 6px 18px; text-align:center; font-family:Orbitron, Roboto, sans-serif; font-weight:900; font-size:clamp(24px, 5vw, 48px); letter-spacing:1px; background:linear-gradient(90deg, var(--a), #ffffff 50%, var(--b)); -webkit-background-clip:text; background-clip:text; color:transparent; text-shadow:0 0 18px rgba(255,215,0,.55), 0 0 28px rgba(0,198,255,.5) }
#screen-gaple .main-content{ display:grid; grid-template-columns:1.7fr 1fr; gap:18px; align-items:start }
@media (max-width: 1024px){ #screen-gaple .main-content{ grid-template-columns:1fr } }
#screen-gaple .panel, #screen-gaple .left-panel{ background:linear-gradient(160deg, var(--panel), var(--panel-2)); border-radius:16px; padding:16px; box-shadow:inset 0 1px 1px rgba(255,255,255,.12), 0 10px 20px rgba(0,0,0,.5); content-visibility:auto; contain:paint; position:relative; isolation:isolate; }
#screen-gaple .panel h3{ margin:0 0 10px; font-family:Orbitron; font-size:1rem; letter-spacing:.8px; color:#f0f8ff; text-shadow:0 0 4px rgba(255,255,255,.18) }
#screen-gaple .panel, #screen-gaple .left-panel{ box-shadow:inset 0 1px 1px rgba(255,255,255,.12), 0 10px 20px rgba(0,0,0,.5), 0 0 14px rgba(57,255,20,.95), 0 0 26px rgba(57,255,20,.7), 0 0 48px rgba(57,255,20,.45), 0 0 72px rgba(57,255,20,.28); }
#screen-gaple .panel::after, #screen-gaple .left-panel::after{ content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none; padding:1.5px; background:linear-gradient(180deg, var(--neon), var(--neon2) 60%, var(--neon)); -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite: xor; mask-composite: exclude; filter: drop-shadow(0 0 12px rgba(57,255,20,.9)) drop-shadow(0 0 24px rgba(57,255,20,.65)) drop-shadow(0 0 46px rgba(57,255,20,.4)); opacity:.96; animation: neonPulse 2.8s ease-in-out infinite; }
@keyframes neonPulse{ 0%,100%{ opacity:.92 } 50%{ opacity:1 } }
@media (prefers-reduced-motion: reduce){ #screen-gaple .panel::after, #screen-gaple .left-panel::after{ animation:none } }
#screen-gaple .board-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:10px }
#screen-gaple .board-title{ font-weight:800; letter-spacing:.7px; text-transform:uppercase; font-size:.95rem; color:#fff5e6 }
#screen-gaple .gaple-board{ position:relative; overflow:hidden; border-radius:18px; height:520px; margin:8px 0 14px; background: radial-gradient(140% 100% at 50% 0%, rgba(255,215,0,.12), transparent 60%), repeating-linear-gradient(0deg, #1a103f 0 6px, #150c35 6px 12px); box-shadow:inset 0 0 0 1px rgba(255,255,255,.1), inset 0 0 70px rgba(0,0,0,.7); contain:paint; content-visibility:auto; contain-intrinsic-size: 520px; }
#screen-gaple .gaple-board::after{ content:""; position:absolute; inset:10px; border-radius:14px; z-index:0; background: radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,.75) 0%, rgba(255,255,255,0) 40%), conic-gradient(from 0deg at 50% 50%, #ff0000 0%, #ff7f00 12%, #ffff00 25%, #00ff00 37%, #00ffff 50%, #0066ff 62%, #8a00ff 75%, #ff00ff 87%, #ff0000 100%), radial-gradient(120% 120% at 50% 50%, rgba(0,0,0,0) 60%, rgba(0,0,0,.6) 100%); filter: brightness(1.05) saturate(1.7) blur(6px); opacity:.95; }
#screen-gaple .gaple-board .spinlight, #screen-gaple .gaple-board .spinlight-ccw{ position:absolute; inset:10px; border-radius:14px; z-index:0; pointer-events:none; mix-blend-mode: screen; }
#screen-gaple .gaple-board .spinlight{ background: radial-gradient(36% 36% at 50% 50%, rgba(255,255,255,.6) 0%, rgba(255,255,255,0) 60%), conic-gradient(from 0deg at 50% 50%, rgba(255,255,255,0) 0%, rgba(255,255,255,0) 44%, rgba(255,255,255,.9) 50%, rgba(255,255,255,0) 56%, rgba(255,255,255,0) 100%); filter: blur(12px) brightness(1.25) saturate(1.15); animation: light-spin 12s linear infinite, light-breath 3s ease-in-out infinite; }
#screen-gaple .gaple-board .spinlight-ccw{ background: radial-gradient(30% 30% at 50% 50%, rgba(255,255,255,.5) 0%, rgba(255,255,255,0) 55%), conic-gradient(from 20deg at 50% 50%, rgba(255,255,255,0) 0%, rgba(255,255,255,0) 47%, rgba(255,255,255,.85) 50%, rgba(255,255,255,0) 53%, rgba(255,255,255,0) 100%); filter: blur(12px) brightness(1.2) saturate(1.1); animation: light-spin-ccw 16s linear infinite, light-breath 3.2s ease-in-out infinite; }
@keyframes light-spin{ to{ transform: rotate(360deg); } }
@keyframes light-breath { 0%,100% { opacity:.75 } 50% { opacity:1 } }
@keyframes light-spin-ccw { to { transform: rotate(-360deg); } }
#screen-gaple .gaple-board .rim{ position:absolute; inset:8px; border-radius:12px; pointer-events:none; box-shadow:inset 0 0 0 2px rgba(255,255,255,.1), inset 0 0 0 6px rgba(255,215,0,.14), inset 0 0 36px rgba(255,215,0,.18) }
#screen-gaple .domino-grid{ position:relative; z-index:3; display:grid; height:100%; padding:16px; gap:12px; grid-template-columns:repeat(7, 1fr); grid-template-rows:repeat(4, 1fr) }
#screen-gaple .domino{ position:relative; width:100%; height:100%; perspective:700px; border-radius:12px; cursor:pointer }
#screen-gaple .domino .inner{ position:absolute; inset:0; transition:transform .55s cubic-bezier(.2,.8,.2,1); transform-style:preserve-3d; will-change:transform; backface-visibility:hidden }
#screen-gaple .domino.flipped .inner{ transform:rotateY(180deg) }
#screen-gaple .face, #screen-gaple .back{ position:absolute; inset:0; border-radius:12px; box-shadow:inset 0 0 0 1px rgba(0,0,0,.15), 0 10px 18px rgba(0,0,0,.42); backface-visibility:hidden }
#screen-gaple .back{ border:4px solid transparent; background: linear-gradient(180deg,#2a1f55,#1c1044) padding-box, linear-gradient(135deg,#fff6cc 0%, #ffe680 20%, #ffd700 45%, #ffb700 65%, #a86d00 82%, #fff2ac 100%) border-box; display:grid; place-items:center; box-shadow:0 0 18px rgba(255,215,0,.38), inset 0 0 0 1px rgba(255,255,255,.1) }
#screen-gaple .back::before{ content:""; position:absolute; inset:3px; border-radius:9px; background: linear-gradient(120deg, rgba(255,255,255,.46) 0%, rgba(255,255,255,0) 42%), radial-gradient(120px 60px at 18% 14%, rgba(255,248,220,.22), rgba(255,248,220,0)); mix-blend:screen; pointer-events:none }
#screen-gaple .back::after{ content:""; position:absolute; left:14px; right:14px; top:12px; bottom:12px; border-radius:10px; background: radial-gradient(70% 60% at 50% 32%, rgba(255,255,255,.95) 0%, rgba(255,255,255,0) 55%), linear-gradient(180deg, #fff6cc 0%, #ffe680 18%, #ffd233 42%, #ffb700 66%, #d08a00 100%); box-shadow: inset 0 10px 16px rgba(255,255,255,.6), inset 0 -12px 18px rgba(168,109,0,.55), 0 0 18px rgba(255,208,0,.42); }
#screen-gaple .face{ background:linear-gradient(180deg,#ffffff,#f0f0e0); transform:rotateY(180deg); border:1px solid rgba(0,0,0,.15) }
#screen-gaple .face::before{ content:""; position:absolute; inset:0; border-radius:12px; background:linear-gradient(70deg, rgba(255,255,255,1), rgba(255,255,255,0) 40%); opacity:.55; transform: translateY(-6px) rotate(8deg); pointer-events:none }
#screen-gaple .divider{ position:absolute; left:50%; top:6px; bottom:6px; width:2px; background:linear-gradient(#c8c8b4,#a1a18d); border-radius:2px }
#screen-gaple .half{ position:absolute; left:6px; right:6px; height:calc(50% - 8px); display:grid; grid-template-columns:repeat(3,1fr); grid-template-rows:repeat(3,1fr); gap:4px; padding:6px }
#screen-gaple .half.top{ top:6px } #screen-gaple .half.bot{ bottom:6px }
#screen-gaple .pip{ width:12px; height:12px; margin:auto; border-radius:50%; box-shadow:0 1px 1px rgba(0,0,0,.3), inset 0 1px 1px rgba(255,255,255,.3); background:radial-gradient(circle at 30% 30%, #ff4747 0%, #e50000 55%, #a00000 100%) }
#screen-gaple .domino.ready .back{ outline:1px solid rgba(255,215,0,.65); box-shadow:0 0 20px rgba(255,215,0,.85), 0 0 38px rgba(255,190,0,.55), 0 0 56px rgba(255,190,0,.35) }
#screen-gaple .shuffle-layer{ position:absolute; inset:0; pointer-events:none; z-index:1 }
#screen-gaple .chip{ position:absolute; width:46px; height:22px; border-radius:6px; background:linear-gradient(180deg,#2a1a5e,#1c1044); box-shadow:inset 0 0 0 1px rgba(255,255,255,.12), 0 3px 8px rgba(0,0,0,.6); opacity:0; animation:shuffle-x .9s ease-in-out infinite, shuffle-pop .2s ease forwards; will-change:transform,opacity }
#screen-gaple .chip::after{ content:""; position:absolute; inset:0; border-radius:6px; background:linear-gradient(90deg, rgba(255,255,255,.25), rgba(255,255,255,.04)); mix-blend:overlay }
@keyframes shuffle-x{0%{transform:translateX(-40px) rotate(-6deg)}50%{transform:translateX(40px) rotate(6deg)}100%{transform:translateX(-40px) rotate(-6deg)}}
@keyframes shuffle-pop{to{opacity:.85}}
#screen-gaple .controls{ display:flex; gap:12px; justify-content:center }
#screen-gaple .btn{ --pad:12px 20px; position:relative; display:inline-flex; align-items:center; justify-content:center; padding:var(--pad); border-radius:14px; border:1px solid rgba(255,255,255,.2); cursor:pointer; user-select:none; font-family:Orbitron, Roboto, sans-serif; font-weight:800; letter-spacing:.7px; text-transform:uppercase; background:linear-gradient(135deg,#2f1a66,#1a0d49); color:#ffffff; text-shadow:0 1px 1px rgba(0,0,0,.5); box-shadow:inset 0 1px 1px rgba(255,255,255,.15), 0 12px 24px rgba(0,0,0,.48), 0 0 22px rgba(0,198,255,.22); transition:transform .12s ease, box-shadow .2s ease; filter:saturate(1.05) }
#screen-gaple .btn.primary{ background:linear-gradient(135deg, var(--a), var(--b)); border-color:rgba(255,255,255,.4); color:#000; text-shadow:0 1px 1px rgba(255,255,255,.3) }
#screen-gaple .btn::before{ content:""; position:absolute; inset:0; border-radius:14px; box-shadow:inset 0 0 0 2px rgba(255,215,0,.28); mix-blend:overlay; opacity:.95; pointer-events:none }
#screen-gaple .btn:hover{ transform:translateY(-1px); box-shadow:0 0 12px rgba(255,215,0,.7), 0 0 24px rgba(255,215,0,.4), 0 0 46px rgba(255,215,0,.25) }
#screen-gaple .btn.primary:hover{ box-shadow:0 0 12px rgba(255,215,0,.7), 0 0 24px rgba(0,198,255,.5) }
#screen-gaple .prize-section{ padding:10px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)); box-shadow:inset 0 0 0 1px rgba(255,255,255,.1) }
#screen-gaple .prize-item{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding:10px; border-radius:10px; background:linear-gradient(160deg,#2a1a5e,#1c1044); box-shadow:inset 0 1px 0 rgba(255,255,255,.08), 0 2px 5px rgba(0,0,0,.28) }
#screen-gaple .badge{ font-size:.72rem; padding:4px 8px; border-radius:20px; letter-spacing:.5px; font-weight:700; font-family:Orbitron; box-shadow: inset 0 1px 1px rgba(255,255,255,.28) }
#screen-gaple .badge.utama{ background:linear-gradient(180deg, #ffd700, #f0c000); color:#4d2c00; border:1px solid #ffde59 }
#screen-gaple .badge.biasa{ background:linear-gradient(180deg, #5bc0de, #46b8da); color:#003366; border:1px solid #7acde6 }
#screen-gaple .prize-item.highlight{ animation:neon 1.2s ease-in-out infinite }
@keyframes neon{0%,100%{box-shadow:0 0 14px rgba(255,215,0,.7), 0 0 24px rgba(0,198,255,.5)} 50%{box-shadow:0 0 26px rgba(255,215,0,1), 0 0 38px rgba(0,198,255,.75)}}
#screen-gaple .prize-result{ display:none; margin-top:16px; padding:16px; border-radius:12px; background:linear-gradient(180deg,#2a1a5e,#1c1044); box-shadow:inset 0 0 0 1px rgba(255,255,255,.1) }
#screen-gaple .prize-result.show{ display:block; animation:up .28s ease }
@keyframes up{from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)}}
#screen-gaple .result-actions{ display:flex; gap:10px; flex-wrap:wrap }
#screen-gaple .btn.claim-wa{ border-color:rgba(34,139,34,.6); background:linear-gradient(180deg,#2e8b57,#1e6a3f); color:white }
#screen-gaple .btn.claim-wa:hover{ box-shadow:0 0 12px #32cd32, 0 0 20px #2e8b57 }
#screen-gaple .btn.claim-tg{ border-color:rgba(30,144,255,.6); background:linear-gradient(180deg,#1e90ff,#104e8b); color:white }
#screen-gaple .btn.claim-tg:hover{ box-shadow:0 0 12px #1e90ff, 0 0 20px #00bfff }
#screen-gaple .tiny{ font-size:.8rem; color:#d1d9ff }
@media (max-width: 520px){ #screen-gaple .gaple-board{height:460px} #screen-gaple .domino-grid{gap:10px; padding:12px} }
@media (prefers-reduced-motion: reduce){ #screen-gaple .gaple-board .spinlight, #screen-gaple .gaple-board .spinlight-ccw{ animation:none } }
#screen-gaple .hadiah-utama{ margin-top:-105px; }
@media (max-width:1024px){ #screen-gaple .hadiah-utama{ margin-top:0; } }
/* ANGKOR BG + WATER + BIRDS */
#screen-gaple .angkor-bg{ position:fixed; inset:0; z-index:-2; overflow:hidden; background:radial-gradient(1200px 900px at 50% 15%, #4b0082 0%, #191970 45%, #050210 100%); contain:paint }
#screen-gaple .angkor-bg .sky{ position:absolute; inset:-15%; background:linear-gradient(180deg,#ff8c00 0%, #ff4500 35%, #4b0082 65%, #191970 100%); filter:saturate(1.25) brightness(1.08); animation:skyPulse 20s ease-in-out infinite; will-change:filter }
@keyframes skyPulse{0%,100%{filter:saturate(1.15) brightness(1.05)}50%{filter:saturate(1.35) brightness(1.12)}}
#screen-gaple .angkor-bg .stars{ position:absolute; inset:-10% 0 0 0; background-image:radial-gradient(#fff 1px, transparent 1.2px); background-size:2px 2px; opacity:.2; animation:twinkle 6s ease-in-out infinite }
@keyframes twinkle{0%,100%{opacity:.15}50%{opacity:.25}}
#screen-gaple .angkor-bg .sun{ position:absolute; top:8vh; left:-20vw; width:min(36vw,520px); height:min(36vw,520px); border-radius:50%; background:radial-gradient(circle at 50% 50%, #ffffff 0%, #fffacd 40%, #ffea00 60%, rgba(255,234,0,0) 70%); filter:blur(7px); opacity:.8; animation:sunGlide 60s linear infinite; will-change:transform }
@keyframes sunGlide{0%{transform:translate(0,0)}50%{transform:translate(60vw,5vh)}100%{transform:translate(120vw,0)}}
#screen-gaple .angkor-bg .cloud{ position:absolute; left:-40%; width:180%; height:52%; bottom:34%; filter:blur(22px); opacity:.3; mix-blend:screen; will-change:transform }
#screen-gaple .angkor-bg .cloud.cloud-1{ background: radial-gradient(ellipse at 30% 60%, rgba(255,228,181,.23), rgba(255,255,255,0) 60%), radial-gradient(ellipse at 60% 55%, rgba(255,228,181,.2), rgba(255,255,255,0) 60%); animation:fogMove 80s linear infinite }
#screen-gaple .angkor-bg .cloud.cloud-2{ bottom:28%; opacity:.25; background: radial-gradient(ellipse at 40% 60%, rgba(240,248,255,.23), transparent 60%), radial-gradient(ellipse at 65% 55%, rgba(255,255,255,.18), transparent 60%); animation:fogMove2 110s linear infinite }
@keyframes fogMove{from{transform:translateX(0)}to{transform:translateX(40%)}}
@keyframes fogMove2{from{transform:translateX(-10%)}to{transform:translateX(55%)}}
#screen-gaple .angkor-bg svg.temples{ position:absolute; left:0; right:0; bottom:-2px; height:58%; width:100%; pointer-events:none }
#screen-gaple .angkor-bg .layer.far{ fill:#191970; opacity:.7; animation:parFar 60s linear infinite; will-change:transform }
#screen-gaple .angkor-bg .layer.mid{ fill:#100828; opacity:.88; animation:parMid 45s linear infinite; will-change:transform }
#screen-gaple .angkor-bg .layer.near{ fill:#050210; opacity:1; filter:drop-shadow(0 0 22px rgba(0,0,0,.45)); animation:parNear 35s linear infinite; will-change:transform }
@keyframes parFar{from{transform:translateX(0)}to{transform:translateX(-60px)}}
@keyframes parMid{from{transform:translateX(0)}to{transform:translateX(-120px)}}
@keyframes parNear{from{transform:translateX(0)}to{transform:translateX(-200px)}}
#screen-gaple .water{ position:absolute; left:0; right:0; bottom:0; height:34%; pointer-events:none; overflow:hidden }
#screen-gaple .water .surface{ position:absolute; inset:0; background: linear-gradient(180deg, rgba(255,100,0,.33) 0%, rgba(138,43,226,.52) 40%, rgba(48,25,52,.88) 100%), repeating-linear-gradient(0deg, rgba(255,255,255,.08) 0 2px, rgba(255,255,255,0) 2px 8px); mix-blend:color-dodge; opacity:.7; animation:waterMove 12s linear infinite; will-change:background-position }
@keyframes waterMove{from{background-position:0 0, 0 0}to{background-position:0 0, 0 40px}}
#screen-gaple .water svg.reflection{ position:absolute; left:0; right:0; bottom:0; height:120%; width:100%; opacity:.5; transform:scaleY(-1) translateY(12%); filter:blur(2px) saturate(128%) }
#screen-gaple .water .mask{ position:absolute; left:0; right:0; bottom:0; height:100%; background:linear-gradient(180deg, rgba(5,2,16,0) 0%, rgba(5,2,16,.35) 45%, rgba(5,2,16,.8) 100%) }
#screen-gaple .water .ripples{ position:absolute; left:-50%; width:200%; height:60%; bottom:10%; opacity:.33; background:radial-gradient(40% 80% at 50% 60%, rgba(255,255,255,.23), rgba(255,255,255,0) 60%) no-repeat; animation:ripples 10s ease-in-out infinite; will-change:transform }
@keyframes ripples{0%,100%{transform:translateX(0)}50%{transform:translateX(10%)}}
/* fireworks */
#b_fxFireworks{ position:fixed; inset:0; z-index:45; pointer-events:none; mix-blend-mode:lighter; display:none; }
#screen-gaple.showing #b_fxFireworks{ display:block; }

/* ===================== PULAU C (GEDOR PINTU HOKI) ‚Äî FULLY SCOPED ===================== */
#screen-gedor{ position:relative; min-height:100vh; color:#e9f0ff; font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; overflow-x:hidden; }
#screen-gedor :where(*){ box-sizing:border-box; }
#screen-gedor{ --bg-1:#090b16; --bg-2:#1a1440; --electric:#27b0ff; --magenta:#ff2ea6; --gold:#ffc94a; --lime:#39ff7f; --cyan:#00e7ff; --text:#e9f0ff; --muted:#a9b0c0; --glass: rgba(255,255,255,.06); --glass-stroke: rgba(255,255,255,.14); }
#screen-gedor .container{ max-width:1200px; margin-inline:auto; padding:120px 20px 120px; position:relative; z-index:2; }
#screen-gedor header{ position:fixed; top:0; left:0; right:0; display:flex; align-items:center; justify-content:space-between; gap:16px; padding:6px 16px; z-index:60; background:linear-gradient(90deg,#0f1830 0%, #252767 48%, #4e2a98 100%); border-bottom:none; }
#screen-gedor header::after{ content:""; position:absolute; left:0; right:0; bottom:0; height:2px; background:linear-gradient(90deg, rgba(0,255,209,0) 0%, #00ffd1 12%, #00b7ff 50%, #00ffd1 88%, rgba(0,255,209,0) 100%); box-shadow:0 0 6px rgba(0,255,209,.55); }
#screen-gedor .brand{ display:flex; align-items:center; gap:12px; font-weight:900; letter-spacing:.06em; text-transform:uppercase; }
#screen-gedor nav{ display:flex; gap:18px; font-weight:800; color:var(--text) }
#screen-gedor .hero{ text-align:center; padding:24px 0 16px; }
#screen-gedor .eyebrow{ font-size:13px; letter-spacing:.28em; text-transform:uppercase; color:var(--muted); opacity:.9 }
#screen-gedor .title{ font-family:Orbitron,Inter,sans-serif; font-weight:800; font-size: clamp(34px, 6vw, 88px); line-height:1.05; margin:8px auto 12px; }
#screen-gedor .title .neon-1{ color:var(--electric); text-shadow: 0 0 12px rgba(39,176,255,.9), 0 0 40px rgba(39,176,255,.45); }
#screen-gedor .title .neon-2{ color:var(--gold); text-shadow: 0 0 14px rgba(255,201,74,.95), 0 0 48px rgba(255,201,74,.55); }
#screen-gedor .subtitle{ color:var(--muted); font-size: clamp(14px, 1.8vw, 18px); margin-bottom:26px; }
#screen-gedor .cta{ display:inline-flex; align-items:center; gap:12px; padding:14px 22px; font-weight:800; letter-spacing:.04em; border-radius:16px; text-decoration:none; color:var(--text); position:relative; isolation:isolate; background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03)); border:1px solid var(--glass-stroke); box-shadow: inset 0 0 0 1px rgba(255,255,255,.06), 0 10px 30px rgba(0,0,0,.5), 0 0 24px rgba(0,231,255,.16); transition: transform .2s ease, box-shadow .2s ease; z-index:70; }
#screen-gedor .cta::before{ content:""; position:absolute; inset:-2px; border-radius:inherit; padding:2px; background:linear-gradient(90deg,#27b0ff,#ff2ea6,#ffc94a,#39ff7f); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.9; filter:blur(.5px); pointer-events:none; }
#screen-gedor .cta:hover{ transform: translateY(-2px); box-shadow: inset 0 0 0 1px rgba(255,255,255,.08), 0 12px 40px rgba(0,0,0,.55), 0 0 36px rgba(39,176,255,.26); }
#screen-gedor .cta[aria-disabled="true"]{ opacity:.6; pointer-events:none; }
#screen-gedor .cta .pulse{ position:absolute; inset:0; border-radius:inherit; box-shadow:0 0 0 0 rgba(39,176,255,.55); animation:pulse 2.6s ease-out infinite; }
@keyframes pulse{ 0%{box-shadow:0 0 0 0 rgba(39,176,255,.55)} 70%{box-shadow:0 0 0 22px rgba(39,176,255,0)} 100%{box-shadow:0 0 0 0 rgba(39,176,255,0)} }
#screen-gedor .doors{ display:grid; grid-template-columns:repeat(3, minmax(220px,1fr)); gap:22px; margin-top:36px; }
@media (max-width:1100px){ #screen-gedor .doors{ grid-template-columns:repeat(2, minmax(220px,1fr)); } }
@media (max-width:600px){ #screen-gedor .doors{ grid-template-columns:repeat(1, minmax(240px,1fr)); } }
#screen-gedor .door{ position:relative; aspect-ratio:3/4; border-radius:20px; padding:0; background:transparent; border:none; overflow:visible; cursor:pointer; transform:translateZ(0); perspective:1200px; isolation:isolate; transition: transform .16s ease, box-shadow .16s ease, filter .16s ease; will-change: transform, filter; contain: layout paint; }
#screen-gedor .door:focus-visible{ outline:2px solid var(--electric); outline-offset:2px }
#screen-gedor .door:hover{ transform: translateY(-6px) scale(1.02); box-shadow: 0 10px 30px rgba(0,0,0,.55), 0 0 30px rgba(255,255,255,.04); animation: vibrate .7s infinite linear; }
#screen-gedor .door.highlight{ transform: translateY(-2px) scale(1.01); box-shadow:0 0 0 3px rgba(39,176,255,.75), 0 0 28px rgba(39,176,255,.45); }
#screen-gedor .door.fly{ z-index:5; filter: drop-shadow(0 14px 30px rgba(39,176,255,.25)) brightness(1.03); }
@keyframes vibrate{ 0%{filter:brightness(1)} 50%{filter:brightness(1.1)} 100%{filter:brightness(1)} }
#screen-gedor .door-pink{ --pink:#ff6faa; --pink-dark:#e85b96; --trim:#e0488a; --knob:#c5e6e6; }
#screen-gedor .door-pink .frame{ position:absolute; inset:10px; border-radius:14px; background:linear-gradient(180deg, var(--pink) 0%, var(--pink-dark) 100%); box-shadow: inset 0 0 0 3px var(--trim), 0 10px 30px rgba(0,0,0,.5); }
#screen-gedor .door-pink .frame::before{ content:""; position:absolute; left:-8px; right:-8px; top:-18px; height:26px; border-radius:8px; background:linear-gradient(180deg, var(--pink) 0%, var(--pink-dark) 100%); box-shadow: inset 0 0 0 3px var(--trim); }
#screen-gedor .door-pink .frame::after{ content:""; position:absolute; left:-10px; right:-10px; bottom:-18px; height:28px; border-radius:10px; background:linear-gradient(180deg, var(--pink) 0%, var(--pink-dark) 100%); box-shadow: inset 0 0 0 3px var(--trim); }
#screen-gedor .door-pink .door-leaf-container{ position:absolute; inset:26px 18px 30px 18px; border-radius:10px; z-index:2; transform-origin:right center; transition: transform .6s cubic-bezier(.2,.85,.25,1); }
#screen-gedor .door-pink.open .door-leaf-container{ transform: perspective(1200px) rotateY(-70deg); }
#screen-gedor .door-pink .leaf{ position:absolute; inset:0; border-radius:10px; background:linear-gradient(180deg, var(--pink) 0%, var(--pink-dark) 100%); box-shadow: inset 0 0 0 3px var(--trim); }
#screen-gedor .door-pink .leaf .side{ position:absolute; top:0; right:-10px; width:10px; height:100%; border-radius:0 10px 10px 0; background:linear-gradient(180deg, #f8b5cc, #f398b9); box-shadow: inset 0 0 0 2px #cf5a92; }
#screen-gedor .door-pink .leaf::after{ content:""; position:absolute; inset:10px; border:2px solid #b9377b; border-radius:6px; opacity:.9; }
#screen-gedor .door-pink .knob{ position:absolute; width:20px; height:20px; border-radius:50%; left:18px; top:50%; transform:translateY(-50%); background:var(--knob); box-shadow: inset 0 0 0 3px #6a8b8b; }
#screen-gedor .door-pink .frame .edge{ position:absolute; top:26px; bottom:30px; right:18px; width:10px; border-radius:0 10px 10px 0; background:linear-gradient(180deg, #f6b0c8, #f29bbd); box-shadow: inset 0 0 0 2px #cf5a92; }
#screen-gedor .inside{ position:absolute; inset:26px 18px 30px 18px; border-radius:10px; background:#0a0d25; display:grid; place-items:center; overflow:hidden; z-index:1; }
#screen-gedor .inside.portal.skin-panel::before,
#screen-gedor .inside.portal.skin-panel::after{ display:none; }
#screen-gedor .inside.portal.skin-panel .panel-bg{ position:absolute; inset:0; border-radius:10px; overflow:hidden; background: linear-gradient(135deg,#ff2ea6 0%,#ffb347 30%,#fff06a 48%,#3cff8f 68%,#23d9ff 100%); filter: saturate(125%) contrast(105%) brightness(105%); }
#screen-gedor .inside.portal.skin-panel .panel-bg::before{
  content:""; position:absolute; inset:10px; border-radius:8px; pointer-events:none;
  background:
    linear-gradient(140deg, rgba(0,0,0,.55) 0 8px, transparent 8px) top left/42% 32% no-repeat,
    linear-gradient(-140deg, rgba(0,0,0,.55) 0 8px, transparent 8px) top right/42% 32% no-repeat,
    linear-gradient(40deg, rgba(0,0,0,.55) 0 8px, transparent 8px) bottom left/42% 32% no-repeat,
    linear-gradient(-40deg, rgba(0,0,0,.55) 0 8px, transparent 8px) bottom right/42% 32% no-repeat,
    radial-gradient(120% 100% at 50% 50%, rgba(0,0,0,0) 55%, rgba(0,0,0,.25) 100%);
  mix-blend-mode:multiply; opacity:.35;
}
#screen-gedor .inside.portal.skin-panel[data-theme="blue"] .panel-bg{ background: linear-gradient(135deg,#49a3ff 0%, #7fd1ff 30%, #9bfff2 55%, #5bffa8 78%, #2ad1ff 100%); }
#screen-gedor .inside.portal.skin-panel[data-theme="magenta"] .panel-bg{ background: linear-gradient(135deg,#ff2ea6 0%, #ff7bd9 35%, #ffd86b 60%, #ffa63d 85%); }
#screen-gedor .inside.portal.skin-panel[data-theme="lime"] .panel-bg{ background: linear-gradient(135deg,#7bffb6 0%, #e6ff7a 45%, #72ffd9 80%); }
#screen-gedor .prize-card{ position:relative; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:8px; padding: clamp(10px, 2.4vw, 16px) clamp(14px, 3vw, 22px); border-radius:16px; background:linear-gradient(180deg, rgba(12,16,28,.82), rgba(8,12,24,.72)); border:1px solid rgba(255,255,255,.12); box-shadow:0 10px 40px rgba(0,0,0,.55), 0 0 36px rgba(39,176,255,.18); backdrop-filter: blur(10px) saturate(120%); }
#screen-gedor .prize-card::before{ content:""; position:absolute; inset:-2px; border-radius:inherit; padding:2px; background:linear-gradient(90deg,#27b0ff,#ff2ea6,#ffc94a,#39ff7f); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.8; filter:blur(.4px); pointer-events:none; }
#screen-gedor .prize-card .prize-label{ font-weight:900; }
#screen-gedor .modal{ position:fixed; inset:0; display:none; place-items:center; padding:24px; z-index:1000; background: radial-gradient(1000px 700px at 50% 20%, rgba(0,231,255,.08), rgba(0,0,0,.65)); }
#screen-gedor .modal.show{ display:grid; }
#screen-gedor .modal-card{ width:min(680px, 96vw); border-radius:24px; padding:28px; background:linear-gradient( to bottom right, rgba(20,28,50,.9), rgba(10,12,22,.9) ); border:1px solid rgba(255,255,255,.12); position:relative; box-shadow: 0 30px 120px rgba(0,0,0,.7), 0 0 80px rgba(39,176,255,.35); text-align:center; }
#screen-gedor .modal-card::before{ content:""; position:absolute; inset:-2px; border-radius:inherit; padding:2px; background:linear-gradient(90deg,#27b0ff,#ff2ea6,#ffc94a,#39ff7f); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; opacity:.9; filter:blur(.5px); pointer-events:none; }
#screen-gedor .modal h2{ font-family:Orbitron,Inter,sans-serif; font-size: clamp(28px, 5vw, 48px); margin:8px 0 6px; }
#screen-gedor .modal .actions{ display:flex; gap:12px; justify-content:center; margin-top:16px; flex-wrap:wrap; }
#screen-gedor .btn{ padding:12px 18px; border-radius:14px; border:1px solid rgba(255,255,255,.16); background:rgba(255,255,255,.06); color:#fff; font-weight:700; text-decoration:none; cursor:pointer; }
#screen-gedor .btn.primary{ background:linear-gradient(180deg, rgba(39,176,255,.2), rgba(39,176,255,.12)); box-shadow:0 0 24px rgba(39,176,255,.35); }
#screen-gedor .toast{ position:fixed; left:50%; transform:translateX(-50%); bottom:20px; background:rgba(12,16,28,.9); border:1px solid rgba(255,255,255,.12); color:#fff; padding:10px 14px; border-radius:12px; font-weight:700; box-shadow:0 10px 30px rgba(0,0,0,.5); opacity:0; pointer-events:none; transition: opacity .25s, transform .25s; z-index:80; }
#screen-gedor .toast.show{ opacity:1; transform: translateX(-50%) translateY(-6px); }
#screen-gedor .cta-bottom{ display:flex; justify-content:center; margin:36px 0 0; }
#screen-gedor .legal-bottom{ position:fixed; bottom:0; left:0; right:0; text-align:center; font-size:12px; color:var(--muted); z-index:30; padding:10px 12px; background:linear-gradient(180deg, rgba(10,14,28,0), rgba(10,14,28,.78)); border-top:1px solid rgba(255,255,255,.08); }
#screen-gedor .brand span{ background:linear-gradient(90deg,#7ecbff 0%, #c594ff 100%); -webkit-background-clip:text; background-clip:text; color:transparent; letter-spacing:.04em; }
#screen-gedor .nav-btn{ color:#06131b; text-decoration:none; padding:6px 12px; border-radius:12px; background:linear-gradient(180deg,#26e2ff,#00a6ff); box-shadow:inset 0 1px 0 rgba(255,255,255,.35), 0 0 0 1px rgba(0,0,0,.2); font-weight:700; border:none; display:inline-flex; align-items:center; justify-content:center; }
#screen-gedor .nav-btn:hover{ filter:brightness(1.06); }
/* Super bright BG layers (scoped) */
#screen-gedor .bg-scan{ position:fixed; inset:-5%; z-index:0; pointer-events:none; mix-blend-mode:screen; filter:saturate(190%) brightness(160%); --gx:-2%; --gy:-2%;
  background: conic-gradient(from 0deg at var(--gx) var(--gy), #ff2ea6 0deg, #ffa33b 60deg, #fff06a 110deg, #32ff62 160deg, #15e8ff 220deg, #2a52ff 280deg, #ff2ea6 360deg);
  animation: scanDiag 12s linear infinite; }
@keyframes scanDiag{ 0%{ --gx:-2%; --gy:-2%; } 50%{ --gx:102%; --gy:102%; } 100%{ --gx:-2%; --gy:-2%; } }
#screen-gedor .bg-fluid{ position:fixed; inset:-8%; z-index:0; pointer-events:none; opacity:.9; display:none !important; }
#screen-gedor .bg-waves{ position:fixed; inset:-15%; z-index:0; pointer-events:none; mix-blend-mode:screen; filter:saturate(200%) brightness(155%); display:none !important; }
</style>
</head>
<body class="flex flex-col min-h-screen overflow-x-hidden" style="overflow-y:auto;">
  <!-- FIXED BACKGROUNDS for Welcome/Game -->
  <div id="bgHero" class="bg-hero"><div class="shine-effect"></div></div>
  <div id="bgGame" class="bg-game hidden"><div class="shine-effect-gold"></div></div>

  <!-- HEADER GLOBAL -->
  <header class="header-full fixed z-50 p-0 m-0">
    <nav class="w-full bg-gradient-to-r from-slate-900 via-indigo-900 to-purple-900 shadow-md">
      <div class="w-full flex items-center justify-between gap-3 px-3 sm:px-6 py-3">
        <a href="#" class="text-xl sm:text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">BELEGENDBET</a>
        <button id="btnHome" class="hover:text-white px-5 py-2 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl font-semibold shadow-lg transition">Beranda</button>
      </div>
    </nav>
  </header>
  <div class="h-16"></div>

  <!-- MAIN: 5 SCREEN DALAM 1 FILE -->
  <main class="flex-grow flex flex-col items-center justify-start w-full relative z-10">
    <!-- SCREEN 1: WELCOME -->
    <section id="screen-welcome" class="w-full flex flex-col items-center justify-start pt-2 pb-0 px-0 section-content">
      <div class="hero-map-frame">
        <div class="neon-glow-border">
          <img src="https://blogger.googleusercontent.com/img/a/AVvXsEi0AVbrC-wW523J76as712cp6lKlhP5hmSeH7CKJYyQZzKZweuzqF7mE4ieM8Wx5nSXlRKVymmcSdjQ2JdVR6tkqknE1E0GqhZDSCbpEjmqOzSPX34EKQ1P0yTXPZllqefxsSso2IzUNvxAOK2xRNUkBZcRIwZ9In9egAaOJ_SxYzQu-nEoHz9ptyq3Vgw" alt="Peta Harta Karun" class="hero-map-img select-none pointer-events-none" />
        </div>
      </div>
      <div class="w-full flex flex-col items-center justify-center mt-6 mb-1">
        <h1 class="glow-hero bg-gradient-to-r from-blue-400 to-emerald-400 bg-clip-text text-transparent text-center drop-shadow-2xl">WELCOME TO THE TREASURE MAP ONE PIECE!</h1>
        <div class="flex flex-col items-center gap-4 mt-8 mb-2 w-full max-w-xs">
          <input id="inpUser" type="text" placeholder="User ID" class="w-full px-4 py-3 rounded-xl border-2 border-blue-400 text-lg font-semibold text-center focus:outline-none focus:ring-2 focus:ring-blue-500 bg-slate-900 text-white placeholder:text-blue-300" autocomplete="off" />
          <input id="inpKupon" type="text" placeholder="Kode Kupon" class="w-full px-4 py-3 rounded-xl border-2 border-green-400 text-lg font-semibold text-center focus:outline-none focus:ring-2 focus:ring-green-500 bg-slate-900 text-white placeholder:text-green-300" autocomplete="off" />
          <button id="btnStart" class="hero-btn bg-gradient-to-r from-blue-500 to-green-500 text-white shadow-lg hover:shadow-2xl hover:scale-105 transition-all duration-300 w-full">Mulai Sekarang</button>
        </div>
      </div>
    </section>

    <!-- SCREEN 2: GAME / KARTU -->
    <section id="screen-game" class="hidden py-8 mx-auto max-w-7xl px-4 text-center w-full section-content">
      <h2 class="neon-title">TEMUKAN PULAU HARTA KARUN</h2>
      <div id="island-container">
        <div class="island-card-wrapper" data-index="0" data-kode="A">
          <div class="island-card">
            <div class="island-front"><img src="https://i.ibb.co/mC1vxmwP/ASAL-JADI-MASUK-AJA-4.png" alt="Logo" class="card-front-logo" /></div>
            <div class="island-back"><img src="https://i.postimg.cc/wvLQbgZ6/ASAL-JADI-MASUK-AJA-6.png" alt="Pulau A" class="island-img" /></div>
          </div>
        </div>
        <div class="island-card-wrapper" data-index="1" data-kode="B">
          <div class="island-card">
            <div class="island-front"><img src="https://i.ibb.co/mC1vxmwP/ASAL-JADI-MASUK-AJA-4.png" alt="Logo" class="card-front-logo" /></div>
            <div class="island-back"><img src="https://i.postimg.cc/pT6q3sXZ/ASAL-JADI-MASUK-AJA-5.png" alt="Pulau B" class="island-img" /></div>
          </div>
        </div>
        <div class="island-card-wrapper" data-index="2" data-kode="C">
          <div class="island-card">
            <div class="island-front"><img src="https://i.ibb.co/mC1vxmwP/ASAL-JADI-MASUK-AJA-4.png" alt="Logo" class="card-front-logo" /></div>
            <div class="island-back"><img src="https://i.postimg.cc/hPZgGBZ4/ASAL-JADI-MASUK-AJA-7.png" alt="Pulau C" class="island-img" /></div>
          </div>
        </div>
        <div class="island-card-wrapper" data-index="3" data-kode="D">
          <div class="island-card">
            <div class="island-front"><img src="https://i.ibb.co/mC1vxmwP/ASAL-JADI-MASUK-AJA-4.png" alt="Logo" class="card-front-logo" /></div>
            <div class="island-back"><img src="https://i.postimg.cc/NMx86bZD/ASAL-JADI-MASUK-AJA-8.png" alt="Pulau D" class="island-img" /></div>
          </div>
        </div>
      </div>
      <button id="spinButton">PUTAR PENGACAK PULAU!</button>
    </section>

    <!-- SCREEN 3: MYSTERY BOX (Pulau A) -->
    <section id="screen-mystery" class="hidden w-full section-content mystery text-white">
      <div class="topbar w-full">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <div class="text-sm md:text-base">
            <span class="opacity-80">User:</span> <b id="tbUser">-</b>
            <span class="mx-2">‚Ä¢</span>
            <span class="opacity-80">Kupon:</span> <b id="tbKupon">-</b>
            <span class="mx-2">‚Ä¢</span>
            <span class="opacity-80">Pulau:</span> <b id="tbPulau">A</b>
          </div>
          <button id="btnBackToMap" class="px-4 py-2 rounded-lg bg-cyan-600 hover:bg-cyan-500 font-semibold shadow">‚üµ Kembali Map</button>
        </div>
      </div>

      <div class="mystery-root">
        <main class="w-full flex flex-col items-center pt-8 pb-28">
          <h1 class="text-4xl md:text-6xl font-extrabold rainbow-neon tracking-widest uppercase drop-shadow-lg mb-6 text-center">MYSTERY BOX</h1>

          <div id="gridBoxes" class="grid grid-cols-3 gap-6 mb-8">
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
            <button class="box-glow w-20 h-20 md:w-28 md:h-28 flex items-center justify-center"><span class="text-4xl md:text-5xl">üéÅ</span></button>
          </div>

          <div class="flex flex-col items-center gap-3">
            <button id="btnSpin" class="px-10 py-3 bg-gradient-to-r from-amber-400 via-yellow-400 to-amber-500 rounded-full text-white text-lg md:text-xl font-bold shadow-xl hover:scale-105 transition-all uppercase tracking-widest border-2 border-amber-300/50">üé≤ SPIN BOX</button>
            <button id="btnShow" class="flex items-center gap-2 px-8 py-3 bg-green-500 hover:bg-green-600 transition-all rounded-full text-white text-base md:text-lg font-semibold shadow-lg"><span>üéÅ</span> Tampilkan Hadiah</button>
          </div>

          <div class="mt-6 text-center">
            <span class="text-lg md:text-2xl font-bold px-4 py-2 rounded-xl bg-red-600 text-white border-2 border-red-400 shadow-md shadow-red-500/50">Buka kotak hadiah dan dapatkan bonus spektakuler!</span>
          </div>

          <section id="listHadiah" class="w-full max-w-[820px] mx-auto mt-6 hidden fade-in">
            <div id="hadiahWrap" class="grid grid-cols-3 gap-4 place-items-center"></div>
          </section>
        </main>

        <div id="modalPrize" class="fixed inset-0 hidden items-center justify-center z-50 modal-bg">
          <div class="relative bg-[#1b1e2a] rounded-2xl shadow-2xl border border-white/10 w-[90%] max-w-xl p-6">
            <h3 class="text-center text-2xl font-extrabold text-yellow-300 mb-4">Hadiah Mystery Box</h3>
            <div class="overflow-hidden rounded-xl border border-white/10">
              <table class="w-full table text-left text-white">
                <thead><tr><th class="py-3 px-4 w-16">No</th><th class="py-3 px-4">Hadiah</th></tr></thead>
                <tbody id="tableBody"></tbody>
              </table>
            </div>
            <div id="resultText" class="text-center text-lg font-bold text-yellow-300 mt-4"></div>
            <div class="flex justify-center mt-5"><button id="btnCloseModal" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-full shadow">Tutup</button></div>
            <button id="btnCloseModal2" class="absolute -top-3 -right-3 bg-red-500 text-white w-9 h-9 rounded-full font-bold shadow">‚úï</button>
          </div>
        </div>
      </div>
    </section>

    <!-- SCREEN 4: GO GAPLE (Pulau B) -->
    <section id="screen-gaple" class="hidden section-content">
      <canvas id="b_fxFireworks" aria-hidden="true"></canvas>

      <header class="site-header">
        <div class="brand">BELEGENDBET</div>
        <a id="b_goHome" class="home-btn" href="#">Beranda</a>
      </header>

      <div class="angkor-bg" aria-hidden="true">
        <div class="sky"></div>
        <div class="stars"></div>
        <div class="sun"></div>
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>

        <svg class="temples" viewBox="0 0 1200 500" preserveAspectRatio="xMidYMax slice">
          <g class="layer far"><path d="M0,500 L0,420 L90,420 L120,370 L150,420 L240,420 L270,360 L300,420 L390,420 L420,340 L450,420 L540,420 L570,370 L600,420 L690,420 L720,360 L750,420 L840,420 L870,340 L900,420 L990,420 L1020,370 L1050,420 L1200,420 L1200,500 Z"/></g>
          <g class="layer mid"><path d="M0,500 L0,440 L80,440 L115,380 L150,440 L235,440 L270,360 L305,440 L390,440 L430,320 L470,440 L555,440 L590,380 L625,440 L710,440 L745,360 L780,440 L865,440 L900,325 L935,440 L1020,440 L1055,380 L1090,440 L1200,440 L1200,500 Z"/></g>
          <g class="layer near"><path d="M0,500 L0,460 L70,460 L110,395 L150,460 L230,460 L270,375 L310,460 L390,460 L440,330 L490,460 L570,460 L615,395 L660,460 L740,460 L780,375 L820,460 L900,460 L945,335 L990,460 L1070,460 L1110,395 L1150,460 L1200,460 L1200,500 Z"/></g>
        </svg>

        <div class="water">
          <svg class="reflection" viewBox="0 0 1200 500" preserveAspectRatio="xMidYMax slice">
            <g class="layer far"><path d="M0,500 L0,420 L90,420 L120,370 L150,420 L240,420 L270,360 L300,420 L390,420 L420,340 L450,420 L540,420 L570,370 L600,420 L690,420 L720,360 L750,420 L840,420 L870,340 L900,420 L990,420 L1020,370 L1050,420 L1200,420 L1200,500 Z"/></g>
            <g class="layer mid"><path d="M0,500 L0,440 L80,440 L115,380 L150,440 L235,440 L270,360 L305,440 L390,440 L430,320 L470,440 L555,440 L590,380 L625,440 L710,440 L745,360 L780,440 L865,440 L900,325 L935,440 L1020,440 L1055,380 L1090,440 L1200,440 L1200,500 Z"/></g>
            <g class="layer near"><path d="M0,500 L0,460 L70,460 L110,395 L150,460 L230,460 L270,375 L310,460 L390,460 L440,330 L490,460 L570,460 L615,395 L660,460 L740,460 L780,375 L820,460 L900,460 L945,335 L990,460 L1070,460 L1110,395 L1150,460 L1200,460 L1200,500 Z"/></g>
          </svg>
          <div class="surface"></div>
          <div class="ripples"></div>
          <div class="mask"></div>
        </div>
      </div>

      <div class="b-wrap">
        <div class="main-container" id="b_app">
          <h1 class="title">DOOR PRIZE GO GAPLE</h1>
          <div class="main-content">
            <section class="left-panel">
              <div class="board-head">
                <div class="board-title">PAPAN GO GAPLE</div>
                <div class="tiny" id="b_hint"></div>
              </div>
              <div class="gaple-board" id="b_board">
                <div class="rim"></div>
                <div class="scan"></div>
              </div>
              <div class="controls">
                <button class="btn primary" id="b_btnStart">PUTAR GO GAPLE</button>
              </div>
            </section>

            <aside class="panel">
              <h3>HADIAH BIASA</h3>
              <div id="b_list-biasa" style="display:grid; gap:8px"></div>
            </aside>

            <aside class="panel hadiah-utama">
              <h3>HADIAH UTAMA</h3>
              <div id="b_list-utama" style="display:grid; gap:8px"></div>
            </aside>

            <aside class="panel">
              <h3>SELAMAT! DAPAT HADIAH</h3>
              <div class="prize-result" id="b_result">
                <div class="tiny" style="margin-bottom:6px">Hasil undian:</div>
                <p class="msg" id="b_resultMsg">‚Äî</p>
                <div class="result-actions">
                  <a class="btn claim-wa" id="b_claimWA" target="_blank" rel="noopener">CLAIM HADIAH WA</a>
                  <a class="btn claim-tg" id="b_claimTG" target="_blank" rel="noopener">CLAIM HADIAH TELEGRAM</a>
                </div>
                <p class="tiny" id="b_footnote" style="margin-top:8px">Kode klaim: ‚Äî</p>
              </div>
            </aside>
          </div>
        </div>
      </div>

      <footer class="site-footer">
        <p>¬© 2024 BELEGENDBET. Hak Cipta Dilindungi Undang-Undang.</p>
      </footer>
    </section>

    <!-- SCREEN 5: GEDOR PINTU HOKI (Pulau C) -->
    <!-- SCREEN 6: PULAU D PRIZE (Pulau D) -->
    <section id="screen-pulau-d" class="hidden w-full section-content text-white">
      <div class="topbar w-full">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <div class="text-sm md:text-base">
            <span class="opacity-80">User:</span> <b id="d_tbUser">-</b>
            <span class="mx-2">‚Ä¢</span>
            <span class="opacity-80">Kupon:</span> <b id="d_tbKupon">-</b>
            <span class="mx-2">‚Ä¢</span>
            <span class="opacity-80">Pulau:</span> <b id="d_tbPulau">D</b>
          </div>
          <button id="d_btnBackToMap" class="px-4 py-2 rounded-lg bg-cyan-600 hover:bg-cyan-500 font-semibold shadow">‚üµ Kembali Map</button>
        </div>
      </div>
      <main class="w-full flex flex-col items-center pt-8 pb-28">
        <h1 class="text-4xl md:text-6xl font-extrabold rainbow-neon tracking-widest uppercase drop-shadow-lg mb-6 text-center">PULAU D PRIZE</h1>
        <div class="flex flex-col items-center gap-3">
          <button id="d_btnSpin" class="px-10 py-3 bg-gradient-to-r from-blue-400 via-green-400 to-blue-500 rounded-full text-white text-lg md:text-xl font-bold shadow-xl hover:scale-105 transition-all uppercase tracking-widest border-2 border-blue-300/50">üé≤ SPIN PRIZE</button>
        </div>
        <div id="d_prizeResult" class="mt-8 text-center text-2xl font-bold text-yellow-300"></div>
        <div id="d_modalPrize" class="fixed inset-0 hidden items-center justify-center z-50 modal-bg">
          <div class="relative bg-[#1b1e2a] rounded-2xl shadow-2xl border border-white/10 w-[90%] max-w-xl p-6">
            <h3 class="text-center text-2xl font-extrabold text-yellow-300 mb-4">Hadiah Pulau D</h3>
            <div class="overflow-hidden rounded-xl border border-white/10">
              <table class="w-full table text-left text-white">
                <thead><tr><th class="py-3 px-4 w-16">No</th><th class="py-3 px-4">Hadiah</th></tr></thead>
                <tbody id="d_tableBody"></tbody>
              </table>
            </div>
            <div id="d_resultText" class="text-center text-lg font-bold text-yellow-300 mt-4"></div>
            <div class="flex justify-center mt-5"><button id="d_btnCloseModal" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-full shadow">Tutup</button></div>
          </div>
        </div>
      </main>
    </section>
    <section id="screen-gedor" class="hidden section-content">
      <!-- super bright conic scan -->
      <div class="bg-scan" aria-hidden="true"></div>

      <div class="container">
        <header>
          <div class="brand" aria-label="Brand"><span>BELEGENDBET</span></div>
          <nav><a href="#" class="nav-btn" id="c_goHome">Beranda</a></nav>
        </header>

        <section class="hero">
          <div class="eyebrow">Event Promosi Eksklusif</div>
          <h1 class="title"><span class="neon-1">GEDOR</span> <span class="neon-2">PINTU HOKI</span></h1>
          <p class="subtitle">Pilih pintumu. Rebut hadiahnya. Mode neon futuristik.</p>
        </section>

        <section class="doors" id="pintu" aria-label="Galeri Pintu">
          <button class="door door-pink" aria-label="Pintu 1"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
          <button class="door door-pink" aria-label="Pintu 2"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
          <button class="door door-pink" aria-label="Pintu 3"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
          <button class="door door-pink" aria-label="Pintu 4"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
          <button class="door door-pink" aria-label="Pintu 5"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
          <button class="door door-pink" aria-label="Pintu 6"><div class="frame"><div class="edge"></div><div class="inside"></div><div class="door-leaf-container"><div class="leaf"><span class="knob"></span><span class="side"></span></div></div></div></button>
        </section>

        <div class="cta-bottom">
          <a class="cta" href="#pintu" role="button" aria-label="Spin Door Prize" id="cta-spin">
            <span class="pulse" aria-hidden="true"></span>üé∞ SPIN DOOR PRIZE
          </a>
        </div>
      </div>

      <footer class="legal-bottom">¬© 2024 BELEGENDBET. Hak Cipta Dilindungi Undang-Undang.</footer>

      <!-- Modal & Toast -->
      <div class="modal" id="winModal" aria-hidden="true" role="dialog" aria-label="Hadiah">
        <div class="modal-card">
          <div class="eyebrow">Selamat!</div>
          <h2 id="modalTitle">Anda Mendapat Hadiah</h2>
          <div class="prize-list-container">
            <table style="width:100%; border-collapse:separate; border-spacing:0; font-size:14px; text-align:left;">
              <thead>
                <tr style="background:#3a1a78; color:#fff;">
                  <th style="padding:10px 16px;">No</th><th style="padding:10px 16px;">Hadiah</th>
                </tr>
              </thead>
              <tbody id="prizeListTableBody"></tbody>
            </table>
          </div>
          <div class="eyebrow" id="winMessage" style="margin-top:10px;"></div>
          <div class="actions">
            <a class="btn primary" id="claimBtn" href="https://klikblg.com/wa-blb" target="_blank" rel="noopener">CLAIM HADIAH WA</a>
            <a class="btn primary" id="joinTgBtn" href="https://t.me/asupanfreebet" target="_blank" rel="noopener">CLAIM HADIAH TELEGRAM</a>
            <button class="btn" id="playAgainBtn">MAIN LAGI</button>
          </div>
        </div>
      </div>
      <div class="toast" id="toast">Hampir! Tekan SPIN dulu.</div>
    </section>
  </main>

  <!-- FOOTER GLOBAL -->
  <footer class="mt-8 py-5 text-center text-gray-400 text-sm border-t border-slate-700 bg-slate-900 z-50 relative">
    <p>&copy; 2024 BELEGENDBET. Hak Cipta Dilindungi Undang-Undang.</p>
  </footer>

<script>
(function(){
  // ====== ELEMENTS ======
  const bgHero = document.getElementById('bgHero');
  const bgGame = document.getElementById('bgGame');
  const scrWelcome = document.getElementById('screen-welcome');
  const scrGame = document.getElementById('screen-game');
  const scrMystery = document.getElementById('screen-mystery');
  const scrGaple = document.getElementById('screen-gaple');
  const scrGedor = document.getElementById('screen-gedor');
  const scrPulauD = document.getElementById('screen-pulau-d');
  const globalHeader = document.querySelector('header.header-full');

  const btnHome = document.getElementById('btnHome');
  const btnStart = document.getElementById('btnStart');
  const inpUser = document.getElementById('inpUser');
  const inpKupon = document.getElementById('inpKupon');
  const btnBackToMap = document.getElementById('btnBackToMap');

  // ====== STATE ======
  let session = null;
  let isSpinning=false, canPick=false, spinInterval=null, spinOrder=[0,1,2,3];

  // ====== UTIL ======
  const show = el => el.classList.remove('hidden');
  const hide = el => el.classList.add('hidden');
  function saveSession(u,k){ session = { userId:u, kupon:k, ts:Date.now(), played:false }; localStorage.setItem('tm_session', JSON.stringify(session)); }
  function setPlayed(){ if(session){ session.played=true; localStorage.setItem('tm_session', JSON.stringify(session)); } }
  function loadSession(){ try{ session = JSON.parse(localStorage.getItem('tm_session')||'null'); }catch(e){ session=null; } }

  function showScreen(name){
  hide(scrWelcome); hide(scrGame); hide(scrMystery); hide(scrGaple); hide(scrGedor); hide(scrPulauD);
  if(name==='welcome'){ show(bgHero); hide(bgGame); show(scrWelcome); globalHeader.classList.remove('hidden'); scrGaple.classList.remove('showing'); }
  if(name==='game'){ hide(bgHero); show(bgGame); show(scrGame); globalHeader.classList.remove('hidden'); scrGaple.classList.remove('showing'); }
  if(name==='mystery'){ hide(bgHero); hide(bgGame); show(scrMystery); globalHeader.classList.remove('hidden'); scrGaple.classList.remove('showing'); }
  if(name==='gaple'){ hide(bgHero); hide(bgGame); show(scrGaple); globalHeader.classList.add('hidden'); scrGaple.classList.add('showing'); }
  if(name==='gedor'){ hide(bgHero); hide(bgGame); show(scrGedor); globalHeader.classList.add('hidden'); scrGaple.classList.remove('showing'); }
  if(name==='pulauD'){ hide(bgHero); hide(bgGame); show(scrPulauD); globalHeader.classList.remove('hidden'); scrGaple.classList.remove('showing'); }
  }

  // ====== WELCOME ======
  btnStart.addEventListener('click', () =>{
    const u = (inpUser.value||'').trim();
    const k = (inpKupon.value||'').trim();
    if(!u || !k){ alert('Silakan masukkan User ID dan Kode Kupon!'); return; }
    saveSession(u,k);
    showScreen('game');
  });
  btnHome.addEventListener('click', ()=>{ resetGame(); showScreen('welcome'); });

  // ====== GAME (KARTU) ======
  const islandContainer = document.getElementById('island-container');
  const islandWrappers = document.querySelectorAll('.island-card-wrapper');
  const islandCards = document.querySelectorAll('.island-card');
  const spinButton = document.getElementById('spinButton');

  function renderIslands(){ const current = Array.from(islandContainer.querySelectorAll('.island-card-wrapper')); islandContainer.innerHTML=''; spinOrder.forEach(i=> islandContainer.appendChild(current[i])); }
  function shuffleArray(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }

  function startSpin(){ if(isSpinning) return; resetGame(); isSpinning=true; canPick=false; spinButton.disabled=true; spinButton.textContent='Mengacak...'; islandCards.forEach(c=>c.classList.add('shuffling-anim'));
    let count=0, totalDuration=2000, shuffleSpeed=80, totalShuffles=Math.floor(totalDuration/shuffleSpeed);
    spinInterval=setInterval(()=>{ shuffleArray(spinOrder); renderIslands(); count++; if(count>=totalShuffles){ clearInterval(spinInterval); isSpinning=false; canPick=true; spinButton.textContent='PILIH SALAH SATU PULAU!'; islandCards.forEach(c=>c.classList.remove('shuffling-anim')); } }, shuffleSpeed);
  }

  function flipCard(cardWrapper){
    if(!canPick || cardWrapper.classList.contains('flipped')) return;
    const card=cardWrapper.querySelector('.island-card'); card.classList.add('flipped');
    canPick=false; spinButton.textContent='MULAI BARU'; spinButton.disabled=false;

    const kode = cardWrapper.getAttribute('data-kode'); loadSession();
    // Only allow play once per session
    if(session && session.played){
      setTimeout(()=>{ alert('Anda sudah bermain. Silakan kembali ke beranda dan login ulang untuk bermain lagi.'); showScreen('welcome'); }, 700);
      return;
    }
    setPlayed();
    setTimeout(()=>{
      if(kode==='A'){
        document.getElementById('tbUser').textContent = session && session.userId ? session.userId : '-';
        document.getElementById('tbKupon').textContent = session && session.kupon ? session.kupon : '-';
        document.getElementById('tbPulau').textContent = 'A';
        initMysteryOnce();
        showScreen('mystery');
      } else if(kode==='B'){
        initGapleOnce();
        showScreen('gaple');
      } else if(kode==='C'){
        initGedorOnce();
        showScreen('gedor');
      } else if(kode==='D'){
        document.getElementById('d_tbUser').textContent = session && session.userId ? session.userId : '-';
        document.getElementById('d_tbKupon').textContent = session && session.kupon ? session.kupon : '-';
        document.getElementById('d_tbPulau').textContent = 'D';
        initPulauDOnce();
        showScreen('pulauD');
      } else {
        alert('Pulau '+kode+' masih disiapkan, BOS.');
      }
    }, 700);
  }

  function resetGame(){ clearInterval(spinInterval); isSpinning=false; canPick=false; spinOrder=[0,1,2,3]; renderIslands(); islandWrappers.forEach(w=> w.querySelector('.island-card').classList.remove('flipped','shuffling-anim')); spinButton.textContent='PUTAR PENGACAK PULAU!'; spinButton.disabled=false; }

  spinButton.addEventListener('click', ()=>{ if(spinButton.textContent==='MULAI BARU') resetGame(); else startSpin(); });
  islandContainer.addEventListener('click', e=>{ if(!canPick) return; const wrap = e.target.closest('.island-card-wrapper'); if(wrap) flipCard(wrap); });

  // ====== MYSTERY (Pulau A) ======
  let mysteryInited=false;
  function initMysteryOnce(){ if(mysteryInited) return; mysteryInited=true;
    const hadiahDisplay = [
      { nominal:"Rp 5.000.000", logo:"üèÖ" },
      { nominal:"Rp 1.000.000", logo:"ü•á" },
      { nominal:"Rp 100.000",  logo:"üí∑" },
      { nominal:"Rp 20.000",   logo:"üí≥" },
      { nominal:"Rp 10.000",   logo:"ü§ë" },
      { nominal:"Rp 8.000",    logo:"ü™ô" },
      { nominal:"Rp 5.000",    logo:"üíµ" },
      { nominal:"Rp 3.000",    logo:"ü™ô" },
      { nominal:"Rp 2.000",    logo:"üí∞" },
    ];
    const prizePool = [2000,3000,5000,8000,10000];

    const hadiahWrap = document.getElementById('hadiahWrap');
    function renderListHadiah(){
      hadiahWrap.innerHTML='';
      hadiahDisplay.forEach(function(h){
        const card=document.createElement('div');
        card.className='w-[110px] md:w-[150px] h-[88px] md:h-[104px] flex flex-col items-center justify-center bg-yellow-100 rounded-xl shadow-md border border-yellow-400/30';
        card.innerHTML='<span class="text-2xl md:text-3xl mb-1">'+h.logo+'</span><span class="text-[13px] md:text-[16px] font-bold text-yellow-800">'+h.nominal+'</span>';
        hadiahWrap.appendChild(card);
      });
    }
    renderListHadiah();

    document.getElementById('btnShow').onclick = function(){ const el=document.getElementById('listHadiah'); el.classList.toggle('hidden'); if(!el.classList.contains('hidden')) el.classList.add('fade-in'); };

    const grid = document.getElementById('gridBoxes');
    let spinning=false, chosen=false;
    function flipShuffle(){
      const items=Array.from(grid.children);
      const first=new Map(items.map(function(el){ return [el, el.getBoundingClientRect()]; }));
      const r=Math.random();
      if(r<0.34) rotateRowsRight(); else if(r<0.68) rotateColsDown(); else randomSwapPairs();
      const after=Array.from(grid.children);
      after.forEach(function(el){
        const f=first.get(el), l=el.getBoundingClientRect();
        const dx=f.left-l.left, dy=f.top-l.top;
        el.style.transform='translate('+dx+'px,'+dy+'px)';
        el.style.transition='transform 0s';
        if(Math.random()<0.25) el.classList.add('twirl');
        requestAnimationFrame(function(){
          el.style.transition='transform 240ms cubic-bezier(.22,.9,.24,.99)';
          el.style.transform='translate(0,0)';
          setTimeout(function(){ el.classList.remove('twirl'); },240);
        });
      });
    }
    function rotateRowsRight(){ const k=Array.from(grid.children); [k[2],k[0],k[1], k[5],k[3],k[4], k[8],k[6],k[7]].forEach(function(el){ grid.appendChild(el); }); }
    function rotateColsDown(){ const k=Array.from(grid.children); [k[6],k[7],k[8], k[0],k[1],k[2], k[3],k[4],k[5]].forEach(function(el){ grid.appendChild(el); }); }
    function randomSwapPairs(){ const k=Array.from(grid.children); const swaps=2+Math.floor(Math.random()*2); for(let s=0;s<swaps;s++){ let a=Math.floor(Math.random()*9), b=Math.floor(Math.random()*9); if(a===b) b=(b+1)%9; if(a>b){const t=a;a=b;b=t;} grid.insertBefore(k[b], k[a]); grid.insertBefore(k[a], k[b+1]||null); } }

    function startSpinBoxes(){ if(spinning) return; spinning=true; chosen=false; Array.from(grid.children).forEach(function(b){ b.classList.remove('picked','disabled'); b.style.pointerEvents='none'; b.querySelector('span').textContent='üéÅ'; }); const btn=document.getElementById('btnSpin'); const endAt=Date.now()+3000; (function step(){ if(Date.now()>endAt){ btn.textContent='üéØ PILIH KOTAK!'; Array.from(grid.children).forEach(function(b){ b.style.pointerEvents='auto'; }); spinning=false; return; } btn.textContent='‚ö° MENGACAK‚Ä¶'; flipShuffle(); setTimeout(step, 60+Math.random()*50); })(); }
    function formatRupiah(n){ return 'Rp '+n.toLocaleString('id-ID'); }

    document.getElementById('btnSpin').onclick = startSpinBoxes;
    grid.addEventListener('click', function(e){
      const el=e.target.closest('button');
      if(!el || spinning || chosen) return;
      chosen=true;
      el.classList.add('picked');
      setTimeout(function(){ el.classList.remove('picked'); },900);
      Array.from(grid.children).forEach(function(b){ b.classList.add('disabled'); });
      const prize=prizePool[Math.floor(Math.random()*prizePool.length)];
      openModalWithPrize(prize);
      document.getElementById('btnSpin').textContent='üé≤ SPIN BOX';
    });

    function openModalWithPrize(prize){
      const tbody=document.getElementById('tableBody'); tbody.innerHTML='';
      hadiahDisplay.forEach(function(h,i){
        const tr=document.createElement('tr');
        const nominalNumber=Number(h.nominal.replace(/\D/g,''));
        tr.innerHTML='<td class="py-2 px-4">'+(i+1)+'</td><td class="py-2 px-4">'+h.nominal+'</td>';
        if(nominalNumber===prize) tr.classList.add('highlight');
        tbody.appendChild(tr);
      });
      var userLabel = (session && session.userId) ? session.userId : '-';
      document.getElementById('resultText').textContent = 'Selamat '+userLabel+'! Kamu mendapatkan '+formatRupiah(prize);
      const m=document.getElementById('modalPrize'); m.classList.remove('hidden'); m.classList.add('flex'); document.body.style.overflow='hidden';
    }
    function closeModal(){ const m=document.getElementById('modalPrize'); m.classList.add('hidden'); m.classList.remove('flex'); document.body.style.overflow=''; }
    document.getElementById('btnCloseModal').onclick = closeModal; document.getElementById('btnCloseModal2').onclick = closeModal;
  }

  btnBackToMap.addEventListener('click', ()=>{ showScreen('game'); });

  // ====== GAPLE (Pulau B) ======
  let gapleInited=false;
  function initGapleOnce(){ if(gapleInited) return; gapleInited=true;

    const BRAND = "DOOR PRIZE GAPLE";
    const DEST_WA = "https://klikblg.com/wa-blb";
    const DEST_TG = "https://t.me/asupanfreebet";
    const MEMBER_LOW_ONLY = true;

    const DECK = (function(){ const arr=[]; let id=0; for(let a=0;a<=6;a++){ for(let b=a;b<=6;b++){ arr.push({id:++id, a:b, b:a, total:a+b, balak:a===b}); } } return arr; })();

    const normalPrize = (t)=> t*1000;
    const balakBase  = (t)=> (t===0?1000:t*1000);
    const balakBig   = (t)=> balakBase(t)*100;

    const listUtama = document.getElementById('b_list-utama');
    const listBiasa = document.getElementById('b_list-biasa');
    (function renderPrizeLists(){
      const fmt = (n)=> n.toLocaleString('id-ID');
      const fragB = document.createDocumentFragment();
      const fragU = document.createDocumentFragment();
      for(let t=1;t<=11;t++){
        const el=document.createElement('div');
        el.className='prize-item'; el.dataset.key='TOTAL-'+t;
        el.innerHTML = '<div><strong>Total Titik '+t+'</strong><div class="tiny">Hadiah: Rp'+fmt(normalPrize(t))+'</div></div><div class="badge biasa">BIASA</div>';
        fragB.appendChild(el);
      }
      for(let n=0;n<=6;n++){
        const tot=n*2, el=document.createElement('div'); el.className='prize-item'; el.dataset.key='BALAK-'+n;
        el.innerHTML = '<div><strong>Balak '+n+' ('+n+'/'+n+')</strong><div class="tiny">BIG PRIZE: Rp'+fmt(balakBig(tot))+'</div></div><div class="badge utama">UTAMA</div>';
        fragU.appendChild(el);
      }
      listBiasa.appendChild(fragB); listUtama.appendChild(fragU);
    })();

    (function spawnBirds(n){
      n = n || 6;
      const bg=document.querySelector('#screen-gaple .angkor-bg');
      const frag=document.createDocumentFragment();
      for(let i=0;i<n;i++){
        const b=document.createElement('div'); b.className='bird';
        b.style.top = (10 + Math.random()*18) + 'vh';
        b.style.animationDuration = (24 + Math.random()*14) + 's';
        b.style.animationDelay = (Math.random()*12).toFixed(2) + 's';
        frag.appendChild(b);
      }
      bg.appendChild(frag);
    })();

    // Fireworks
    const FX = (function(){
      const cvs = document.getElementById('b_fxFireworks');
      const ctx = cvs.getContext('2d', { alpha:true });
      let W,H, raf=null; const particles=[]; const GRAV=0.05; const FRICTION=0.985;
      const DPR = Math.min(1.5, window.devicePixelRatio||1);
      function resize(){ W=innerWidth; H=innerHeight; cvs.width=W*DPR; cvs.height=H*DPR; cvs.style.width=W+'px'; cvs.style.height=H+'px'; ctx.setTransform(DPR,0,0,DPR,0,0); }
      let resizeRAF=null; addEventListener('resize', function(){ if(resizeRAF) return; resizeRAF=requestAnimationFrame(function(){ resize(); resizeRAF=null; }); }, {passive:true});
      resize();

      function addBurst(opts){
        opts = opts || {};
        const x = (opts.x!=null?opts.x:innerWidth*0.5);
        const y = (opts.y!=null?opts.y:innerHeight*0.3);
        const count = (opts.count!=null?opts.count:100);
        const spread = (opts.spread!=null?opts.spread:Math.PI*2);
        const speed = (opts.speed!=null?opts.speed:5);
        const hueBase = (opts.hueBase!=null?opts.hueBase:Math.random()*360);
        for(let i=0;i<count;i++){
          const a = (i/count)*spread + Math.random()*0.1;
          const sp = speed*(0.6 + Math.random()*0.8);
          particles.push({x:x,y:y,vx:Math.cos(a)*sp,vy:Math.sin(a)*sp,life:60+Math.random()*30,hue:hueBase + (Math.random()*80-40),size:2+Math.random()*2,alpha:1});
        }
        if(!raf) raf=requestAnimationFrame(tick);
      }
      function tick(){
        ctx.clearRect(0,0,W,H);
        if(!particles.length){ raf=null; return; }
        ctx.globalCompositeOperation='lighter';
        for(let i=particles.length-1;i>=0;i--){
          const p=particles[i];
          p.vx*=FRICTION; p.vy*=FRICTION; p.vy+=GRAV; p.x+=p.vx; p.y+=p.vy; p.life--; p.alpha=Math.max(0, p.life/90);
          ctx.fillStyle='hsla('+p.hue+',100%,60%,'+p.alpha+')';
          ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill();
          if(p.life<=0 || p.y>H+20) particles.splice(i,1);
        }
        raf=requestAnimationFrame(tick);
      }
      return { burst: function(big){ addBurst({count: big?160:100, speed: big?7:5, hueBase: Math.random()*360}); } };
    })();

    const board = document.getElementById('b_board');
    const btnStart = document.getElementById('b_btnStart');
    const hint = document.getElementById('b_hint');
    const resultBox = document.getElementById('b_result');
    const resultMsg = document.getElementById('b_resultMsg');
    const claimWA = document.getElementById('b_claimWA');
    const claimTG = document.getElementById('b_claimTG');
    const footnote = document.getElementById('b_footnote');
    const goHome = document.getElementById('b_goHome');

    let lockPick=false; let chosen=null;

    function clearHighlights(){
      document.querySelectorAll('#screen-gaple .prize-item.highlight').forEach(function(el){ el.classList.remove('highlight'); });
    }

    function makeShuffle(){
      board.innerHTML = '<div class="rim"></div><div class="spinlight" aria-hidden="true"></div><div class="spinlight-ccw" aria-hidden="true"></div><div class="scan"></div>';
      const layer = document.createElement('div'); layer.className='shuffle-layer';
      const frag = document.createDocumentFragment();
      board.appendChild(layer);
      const bw = board.clientWidth-46, bh = board.clientHeight-22;
      const N = 36;
      for(let i=0;i<N;i++){
        const c=document.createElement('div'); c.className='chip';
        c.style.left=(Math.random()*bw)+'px';
        c.style.top=(Math.random()*bh)+'px';
        c.style.animationDelay=(Math.random()*0.6).toFixed(2)+'s';
        c.style.animationDuration=(0.6+Math.random()*0.9).toFixed(2)+'s';
        frag.appendChild(c);
      }
      layer.appendChild(frag);
      hint.textContent = 'Mengacak kartu...';
    }

    function showGrid(){
      board.innerHTML = '<div class="rim"></div><div class="spinlight" aria-hidden="true"></div><div class="spinlight-ccw" aria-hidden="true"></div><div class="scan"></div>';
      const grid = document.createElement('div'); grid.className='domino-grid';
      const frag = document.createDocumentFragment();
      for(let i=0;i<28;i++) frag.appendChild(makeBackDomino());
      grid.appendChild(frag); board.appendChild(grid);
      hint.textContent='PILIH 1 GAPLE';
    }

    function makeBackDomino(){
      const root = document.createElement('div'); root.className='domino ready';
      const inner = document.createElement('div'); inner.className='inner'; root.appendChild(inner);
      const back = document.createElement('div'); back.className='back'; inner.appendChild(back);
      const face = document.createElement('div'); face.className='face'; inner.appendChild(face);
      const divv = document.createElement('div'); divv.className='divider'; face.appendChild(divv);
      const top = document.createElement('div'); top.className='half top'; face.appendChild(top);
      const bot = document.createElement('div'); bot.className='half bot'; face.appendChild(bot);
      root.addEventListener('click', function(){ onPick(root, top, bot); }, {passive:true});
      return root;
    }

    function onPick(cardEl, topHalf, botHalf){
      if(lockPick) return; lockPick=true;
      document.querySelectorAll('#screen-gaple .domino').forEach(function(n){ n.classList.remove('ready'); n.style.pointerEvents='none'; });

      const pool = DECK.filter(function(t){ return MEMBER_LOW_ONLY ? (!t.balak && t.total>=1 && t.total<=8) : true; });
      chosen = pool[Math.floor(Math.random()*pool.length)];

      drawHalf(topHalf, chosen.a); drawHalf(botHalf, chosen.b);
      cardEl.classList.add('flipped');

      clearHighlights();
      const key = chosen.balak ? ('BALAK-'+chosen.a) : ('TOTAL-'+chosen.total);
      const target = document.querySelector('#screen-gaple .prize-item[data-key="'+key+'"]');
      if(target){ target.classList.add('highlight'); target.scrollIntoView({behavior:'smooth', block:'center'}); }

      const base = chosen.balak ? balakBase(chosen.total) : normalPrize(chosen.total);
      const payout = chosen.balak ? balakBig(chosen.total) : base;
      const label = chosen.balak ? ('BALAK '+chosen.a+' ('+chosen.a+'/'+chosen.b+') ‚Äî BIG PRIZE') : (chosen.a+'/'+chosen.b+' (Total '+chosen.total+')');

      const code = makeCode();
      resultMsg.innerHTML = 'Kamu membuka <strong>'+label+'</strong>.<br>Hadiah: <strong>Rp'+payout.toLocaleString('id-ID')+'</strong>';
      footnote.textContent = 'Kode klaim: '+code;
      claimWA.href = DEST_WA;
      claimTG.href = DEST_TG;
      resultBox.classList.add('show');

      confetti(board, chosen.balak?120:60);
      FX.burst(!!chosen.balak);
    }

    const POS = { TL:[0,0], TC:[1,0], TR:[2,0], CL:[0,1], CC:[1,1], CR:[2,1], BL:[0,2], BC:[1,2], BR:[2,2] };
    const LAYOUTS = { 0:[], 1:['CC'], 2:['TL','BR'], 3:['TL','CC','BR'], 4:['TL','TR','BL','BR'], 5:['TL','TR','CC','BL','BR'], 6:['TL','TR','CL','CR','BL','BR'] };
    function drawHalf(container, n){
      container.innerHTML='';
      const keys = LAYOUTS[n];
      for(let i=0;i<keys.length;i++){
        const key = keys[i], p=document.createElement('span'); p.className='pip';
        p.style.gridColumnStart=POS[key][0]+1; p.style.gridRowStart=POS[key][1]+1;
        container.appendChild(p);
      }
    }

    function makeCode(){ const s='ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; let r=''; for(let i=0;i<6;i++) r+= s[Math.floor(Math.random()*s.length)]; return r; }
    function confetti(container, count){
      count = count|0 || 40;
      for(let i=0;i<count;i++){
        const f=document.createElement('i');
        f.style.position='absolute';
        f.style.left=Math.random()*100+'%';
        f.style.top='-10px';
        f.style.width='6px'; f.style.height='10px'; f.style.borderRadius='2px';
        f.style.background='hsl('+(Math.random()*360)+',90%,65%)';
        f.style.transform='rotate('+(Math.random()*180)+'deg)';
        const dur = 2+Math.random()*2;
        const delay = Math.random()*2;
        f.style.animation='fall '+dur+'s '+delay+'s linear 1 both';
        f.addEventListener('animationend', function(){ f.remove(); }, {once:true});
        container.appendChild(f);
      }
      if(!document.getElementById('confetti-anim')){
        const anim = document.createElement('style'); anim.id='confetti-anim';
        anim.textContent='@keyframes fall{to{transform:translateY(120vh) rotate(720deg); opacity:0;}}';
        document.head.appendChild(anim);
      }
    }

    const btnStartHandler = function(){
      if(lockPick){
        lockPick=false; showGrid(); clearHighlights();
        resultBox.classList.remove('show');
        return;
      }
      lockPick=true;
      btnStart.disabled=true; hint.textContent='Mengacak kartu...';
      makeShuffle();
      setTimeout(function(){
        showGrid();
        btnStart.disabled=false;
        lockPick=false;
      }, 2500);
    };
    document.getElementById('b_btnStart').addEventListener('click', btnStartHandler);

    document.getElementById('b_goHome').addEventListener('click', function(e){ e.preventDefault(); resultBox.classList.remove('show'); showScreen('welcome'); });

    showGrid();
  }

  // ====== GEDOR PINTU HOKI (Pulau C) ‚Äî Scoped Init ======
  let gedorInited=false;
  function initGedorOnce(){ if(gedorInited) return; gedorInited=true;
    const root = document.getElementById('screen-gedor');
    // Elements (scoped)
    const doorsContainer = root.querySelector('.doors');
    const doors = [...root.querySelectorAll('.door')];
    const ctaSpin = root.querySelector('#cta-spin');
    const toast = root.querySelector('#toast');
    const modal = root.querySelector('#winModal');
    const modalTitle = root.querySelector('#modalTitle');
    const prizeListTableBody = root.querySelector('#prizeListTableBody');
    const winMessageEl = root.querySelector('#winMessage');
    const claimBtn = root.querySelector('#claimBtn');
    const joinTgBtn = root.querySelector('#joinTgBtn');
    const playAgainBtn = root.querySelector('#playAgainBtn');
    const goHomeBtn = root.querySelector('#c_goHome');

    const DOOR_COUNT = doors.length;

    // State
    let selectEnabled = false, spinActive = false, gameLocked = false;

    // Prize data
    const prizes = [
      { amount: "Rp 5.000.000" },
      { amount: "Rp 1.000.000" },
      { amount: "Rp 100.000"  },
      { amount: "Rp 20.000"   },
      { amount: "Rp 10.000"   },
      { amount: "Rp 8.000"    },
      { amount: "Rp 5.000"    },
      { amount: "Rp 3.000"    },
      { amount: "Rp 2.000"    }
    ];
    const ALLOWED_AMOUNTS = ['Rp 5.000','Rp 3.000','Rp 2.000'];
    const allowedSet = new Set(ALLOWED_AMOUNTS);
    const portalThemes = ['blue','magenta','lime','blue','magenta','lime'];
    const doorPrize = new WeakMap();

    // Helpers
    const wait = (ms)=> new Promise(r=>setTimeout(r, ms));
    function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
    function assignPrizesToDoors(){ const pick = shuffle([...prizes]).slice(0, DOOR_COUNT); doors.forEach((d,i)=> doorPrize.set(d, pick[i])); }
    function coerceAllowed(p){ if(!p || typeof p.amount!=='string' || !allowedSet.has(p.amount)){ return { amount: ALLOWED_AMOUNTS[Math.floor(Math.random()*ALLOWED_AMOUNTS.length)] }; } return p; }
    function showToast(msg){ toast.textContent = msg; toast.classList.add('show'); clearTimeout(showToast.t); showToast.t = setTimeout(() => toast.classList.remove('show'), 1500); }

    // Start/reset
    function startGame(){
      gameLocked = false; selectEnabled = false; spinActive = false;
      assignPrizesToDoors();
      doors.forEach(d=>{
        d.classList.remove('open','highlight','is-picked','fly');
        d.style.transition = ''; d.style.transform='';
        const inside = d.querySelector('.inside');
        inside.className = 'inside'; inside.innerHTML = '';
        inside.removeAttribute('data-theme'); inside.removeAttribute('data-state');
        d.style.pointerEvents = 'auto';
      });
      ctaSpin.style.display='inline-flex';
      ctaSpin.setAttribute('aria-disabled','false');
      if (playAgainBtn) playAgainBtn.style.display='none';
    }
    startGame();

    // Listeners (scoped)
    doors.forEach((door)=>{
      door.addEventListener('click', ()=>{
        if(!selectEnabled || gameLocked){ if(!spinActive) showToast('Tekan SPIN dulu'); return; }
        handleDoorEl(door);
      });
    });
    ctaSpin.addEventListener('click', (e)=>{ e.preventDefault(); startSpinShuffle(); });
    goHomeBtn.addEventListener('click', (e)=>{ e.preventDefault(); modal.classList.remove('show'); showScreen('welcome'); });

    // Spin fisik
    async function startSpinShuffle(){
      if(spinActive || gameLocked) return;
      spinActive = true; selectEnabled = false;
      ctaSpin.setAttribute('aria-disabled','true');

      const cycles = 12;
      for (let c = 0; c < cycles; c++){
        const t = c / (cycles - 1);
        const dur = Math.round(70 + t*150);
        await flipOnce(dur, t);
        await wait(10 + t*40);
      }

      spinActive = false; selectEnabled = true;
      ctaSpin.setAttribute('aria-disabled','false');
      showToast('Pilih 1 pintu');
    }

    async function flipOnce(duration, t){
      const first = new Map(); doors.forEach(d=> first.set(d, d.getBoundingClientRect()));
      const order = [...doors]; for(let i=order.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [order[i],order[j]]=[order[j],order[i]]; }
      order.forEach(d=> doorsContainer.appendChild(d));
      const last = new Map(); doors.forEach(d=> last.set(d, d.getBoundingClientRect()));

      doors.forEach(d=>{
        const a = first.get(d), b = last.get(d);
        const dx = a.left - b.left; const dy = a.top - b.top;
        const baseTurns = 3 - 2*t; const turns = Math.max(1, Math.round(baseTurns + Math.random()*0.6));
        const dir = Math.random()<.5 ? -1 : 1;
        const tilt = (Math.random()*10 - 5).toFixed(2);
        d.classList.add('fly');
        d.style.willChange='transform';
        d.style.transition = `transform ${duration}ms cubic-bezier(.2,.85,.25,1)`;
        d.style.transform = `translate(${dx}px, ${dy}px) rotate(${tilt}deg) scale(.96)`;
        void doorsContainer.offsetWidth;
        const endRotate = dir * turns * 360;
        d.style.transform = `translate(0,0) rotate(${endRotate}deg) scale(1)`;
      });

      await wait(duration + 30);
      doors.forEach(d=>{ d.classList.remove('fly'); d.style.transition=''; d.style.transform=''; d.style.willChange=''; });
    }

    function handleDoorEl(selectedDoor){
      if(gameLocked) return;
      gameLocked = true; selectEnabled = false;
      ctaSpin.style.display='none';

      playWhoosh(() => {
        doors.forEach((d,i)=>{
          d.classList.add('open'); d.style.pointerEvents='none';
          const inside = d.querySelector('.inside');
          let chosen = doorPrize.get(d);
          if(d===selectedDoor){ chosen = coerceAllowed(chosen); doorPrize.set(d, chosen); }
          const amount = chosen?.amount || 'Rp 0';
          const type = (amount.includes('1.000.000') || amount.includes('5.000.000')) ? 'diamond'
                    : amount.includes('2.000') ? 'coin' : 'star';

          inside.classList.add('portal','skin-panel');
          inside.setAttribute('data-theme', portalThemes[i % portalThemes.length]);
          inside.setAttribute('data-state', d===selectedDoor ? 'selected' : 'showcase');
          inside.innerHTML = `
            <div class="panel-bg"></div>
            <div class="prize-card">
              ${getPrizeSVG(type)}
              <div class="prize-label">${amount}</div>
            </div>
          `;
          if(d===selectedDoor) d.classList.add('is-picked'); else d.classList.remove('is-picked');
        });

        setTimeout(()=>{ playChaChing(); revealWin(doorPrize.get(selectedDoor)); }, 1100);
      });
    }

    function revealWin(winPrize){
      const winning = winPrize && typeof winPrize.amount==='string' ? winPrize.amount : null;
      if(!winning){ showToast('Data hadiah belum siap. Mengulang‚Ä¶'); return startGame(); }

      modalTitle.textContent = "Anda Mendapat Hadiah";
      winMessageEl.textContent = `Selamat berakah! Kamu mendapatkan ${winning}`;

      const rows = prizes.map((p,i)=>{
        const cls = (p.amount===winning) ? ' style="background:#a6ffff;color:#0a0d25;font-weight:900;"' : '';
        return `<tr${cls}><td style="padding:10px 16px;border-bottom:1px solid #23194a;">${i+1}</td><td style="padding:10px 16px;border-bottom:1px solid #23194a;">${p.amount}</td></tr>`;
      }).join('');
      prizeListTableBody.innerHTML = rows;

      modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
    }

    function getPrizeSVG(type){
      switch(type){
        case 'diamond': return `<svg width="96" height="96" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg" aria-label="Diamond"><defs><linearGradient id="g1" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#9be9ff"/><stop offset="100%" stop-color="#49c9ff"/></linearGradient></defs><polygon points="12,32 32,12 64,12 84,32 48,84" fill="url(#g1)" stroke="#1aa3e6" stroke-width="3"/></svg>`;
        case 'coin':    return `<svg width="96" height="96" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg" aria-label="Coin"><defs><radialGradient id="g3" cx="50%" cy="40%" r="60%"><stop offset="0%" stop-color="#fff3a6"/><stop offset="100%" stop-color="#f2b705"/></radialGradient></defs><ellipse cx="48" cy="48" rx="34" ry="28" fill="url(#g3)" stroke="#b58100" stroke-width="3"/></svg>`;
        default:        return `<svg width="96" height="96" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg" aria-label="Star"><polygon points="48,8 58,36 88,36 62,54 72,84 48,66 24,84 34,54 8,36 38,36" fill="#ffd24f" stroke="#b58100" stroke-width="3"/></svg>`;
      }
    }

    // Modal actions
    claimBtn.addEventListener('click', ()=>{ modal.classList.remove('show'); setTimeout(startGame, 300); });
    joinTgBtn.addEventListener('click', ()=>{ modal.classList.remove('show'); setTimeout(startGame, 300); });
    playAgainBtn.addEventListener('click', ()=>{ modal.classList.remove('show'); startGame(); });
    modal.addEventListener('click', (e)=>{ if(e.target===modal){ modal.classList.remove('show'); startGame(); } });

    // Audio ringan (scoped ke interaction)
    let audioCtx;
    function getCtx(){ if(!audioCtx){ audioCtx = new (window.AudioContext || window.webkitAudioContext)(); } if(audioCtx.state === 'suspended') audioCtx.resume(); return audioCtx; }
    window.addEventListener('pointerdown', ()=>{ try{ getCtx(); }catch(e){} }, {once:true, passive:true});

    function playWhoosh(done){
      const ctx = getCtx(); const dur = 0.45;
      const bufferSize = ctx.sampleRate * dur, buffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate), data = buffer.getChannelData(0);
      for(let i=0;i<bufferSize;i++) data[i] = Math.random()*2-1;
      const src = ctx.createBufferSource(); src.buffer = buffer;
      const filter = ctx.createBiquadFilter(); filter.type='lowpass'; filter.frequency.setValueAtTime(400, ctx.currentTime); filter.frequency.exponentialRampToValueAtTime(8000, ctx.currentTime + dur);
      const gain = ctx.createGain(); gain.gain.setValueAtTime(0.0001, ctx.currentTime); gain.gain.exponentialRampToValueAtTime(.6, ctx.currentTime+0.05); gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+dur);
      src.connect(filter).connect(gain).connect(ctx.destination); src.start(); src.onended = ()=> done && done();
    }
    function playChaChing(){
      const ctx = getCtx(); const t0 = ctx.currentTime + 0.02;
      const o1 = ctx.createOscillator(); o1.type='triangle'; const g1 = ctx.createGain(); g1.gain.setValueAtTime(0.0001, t0); g1.gain.exponentialRampToValueAtTime(0.7, t0+0.02); g1.gain.exponentialRampToValueAtTime(0.0001, t0+0.7); o1.frequency.setValueAtTime(1100, t0); o1.frequency.exponentialRampToValueAtTime(1600, t0+0.08);
      const o2 = ctx.createOscillator(); o2.type='square';   const g2 = ctx.createGain(); g2.gain.setValueAtTime(0.0001, t0); g2.gain.exponentialRampToValueAtTime(0.35, t0+0.02); g2.gain.exponentialRampToValueAtTime(0.0001, t0+0.55); o2.frequency.setValueAtTime(660, t0);  o2.frequency.exponentialRampToValueAtTime(990, t0+0.06);
      const nDur=0.09; const b = ctx.createBuffer(1, ctx.sampleRate*nDur, ctx.sampleRate); const d=b.getChannelData(0); for(let i=0;i<d.length;i++) d[i]=Math.random()*2-1;
      const n = ctx.createBufferSource(); n.buffer=b; const ng=ctx.createGain(); ng.gain.setValueAtTime(0.4, t0); ng.gain.exponentialRampToValueAtTime(0.0001, t0+nDur);
      o1.connect(g1).connect(ctx.destination); o2.connect(g2).connect(ctx.destination); n.connect(ng).connect(ctx.destination);
      o1.start(t0); o2.start(t0+0.02); n.start(t0); o1.stop(t0+0.7); o2.stop(t0+0.55); n.stop(t0+nDur);
    }
  }

  // INIT
  loadSession();
  showScreen('welcome');
})();
</script>
</body>
</html>
